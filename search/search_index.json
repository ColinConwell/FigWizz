{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"],"fields":{"title":{"boost":1000.0},"text":{"boost":1.0},"tags":{"boost":1000000.0}}},"docs":[{"location":"","title":"FigWizz","text":"<p>Python toolkit for programmatic figure design.</p>"},{"location":"#overview","title":"Overview","text":"<p>FigWizz is a comprehensive Python toolkit that simplifies working with images, figures, and scientific visualizations. Whether you're preparing figures for publications, creating image workflows, or automating visual content generation, FigWizz provides intuitive tools to get the job done.</p>"},{"location":"#key-features","title":"Key Features","text":"<ul> <li>Format Conversion: Seamlessly convert images between formats (PNG, JPEG, PDF, SVG)</li> <li>Presentation Processing: Convert PowerPoint/Keynote slides to images with auto-cropping</li> <li>Image Scraping: Extract figures from PDFs and websites</li> <li>Stock Images: Download images from Pixabay and Unsplash</li> <li>AI Generation: Generate images from text prompts using AI models</li> <li>Image Modification: Create hexicons, n-gon crops, and apply transformations</li> <li>Flexible Input: Work with paths, PIL Images, bytes, numpy arrays, URLs, and more</li> </ul>"},{"location":"#quick-start","title":"Quick Start","text":""},{"location":"#installation","title":"Installation","text":"<pre><code>pip install figwizz\n</code></pre> <p>For AI image generation support: <pre><code>pip install figwizz[genai]\n</code></pre></p> <p>For development: <pre><code>pip install figwizz[dev]\n</code></pre></p>"},{"location":"#basic-usage","title":"Basic Usage","text":"<p>Convert an image: <pre><code>from figwizz import convert_image\nconvert_image('input.png', 'jpg')\n</code></pre></p> <p>Create a hexicon: <pre><code>from figwizz import make_hexicon\nhexicon = make_hexicon('logo.png', border_size=10, border_color='auto')\nhexicon.save('hexicon.png')\n</code></pre></p> <p>Download stock images: <pre><code>from figwizz import download_stock_images\nimages = download_stock_images('mountains', n_images=5, \n                                output_dir='images', \n                                provider='unsplash')\n</code></pre></p> <p>Convert slides to images: <pre><code>from figwizz import slides_to_images\nslides_to_images('presentation.pptx', 'figures/', crop_images=True)\n</code></pre></p>"},{"location":"#documentation-structure","title":"Documentation Structure","text":"<ul> <li>Installation Guide - Detailed installation instructions</li> <li>Quick Start - Get started quickly with common workflows</li> <li>Workflows - Organized by use case:</li> <li>Image Conversion</li> <li>Image Modification</li> <li>Scraping</li> <li>Presentations</li> <li>Icons &amp; Hexicons</li> <li>AI Generation</li> <li>API Reference - Complete module documentation</li> </ul>"},{"location":"#requirements","title":"Requirements","text":"<ul> <li>Python &gt;= 3.7</li> <li>numpy</li> <li>PIL/Pillow</li> <li>matplotlib</li> <li>requests</li> <li>beautifulsoup4</li> </ul> <p>Optional dependencies: - PyMuPDF (for PDF extraction) - cairosvg (for SVG conversion) - litellm (for AI image generation)</p>"},{"location":"installation/","title":"Installation","text":""},{"location":"installation/#basic-installation","title":"Basic Installation","text":"<p>Install FigWizz using pip:</p> <pre><code>pip install figwizz\n</code></pre> <p>This installs the core package with basic dependencies.</p>"},{"location":"installation/#optional-dependencies","title":"Optional Dependencies","text":"<p>FigWizz has several optional feature sets that can be installed as needed.</p>"},{"location":"installation/#ai-image-generation","title":"AI Image Generation","text":"<p>To use AI-powered image generation:</p> <pre><code>pip install figwizz[genai]\n</code></pre> <p>This installs <code>litellm</code> for accessing various AI image generation APIs.</p>"},{"location":"installation/#development-tools","title":"Development Tools","text":"<p>For contributing to FigWizz:</p> <pre><code>pip install figwizz[dev]\n</code></pre> <p>This installs testing and code quality tools (pytest, black, isort).</p>"},{"location":"installation/#documentation-building","title":"Documentation Building","text":"<p>To build documentation locally:</p> <pre><code>pip install figwizz[docs]\n</code></pre> <p>This installs mkdocs and related documentation tools.</p>"},{"location":"installation/#all-optional-dependencies","title":"All Optional Dependencies","text":"<p>To install everything:</p> <pre><code>pip install figwizz[genai,dev,docs]\n</code></pre>"},{"location":"installation/#platform-specific-features","title":"Platform-Specific Features","text":"<p>Some features require platform-specific tools:</p>"},{"location":"installation/#pdf-extraction","title":"PDF Extraction","text":"<p>For extracting images from PDFs, install PyMuPDF:</p> <pre><code>pip install PyMuPDF\n</code></pre>"},{"location":"installation/#svg-conversion","title":"SVG Conversion","text":"<p>For converting SVG images to raster formats:</p> <pre><code>pip install cairosvg\n</code></pre>"},{"location":"installation/#presentation-conversion","title":"Presentation Conversion","text":"<p>Presentation slide conversion works differently on each platform:</p> <p>macOS: Uses AppleScript (built-in) - Requires Keynote for <code>.key</code> files - Requires Microsoft PowerPoint for <code>.ppt/.pptx</code> files</p> <p>Windows: Uses COM interface <pre><code>pip install pywin32\n</code></pre></p> <p>Linux: Uses LibreOffice <pre><code># Ubuntu/Debian\nsudo apt-get install libreoffice\n\n# Fedora\nsudo dnf install libreoffice\n</code></pre></p>"},{"location":"installation/#environment-setup","title":"Environment Setup","text":"<p>FigWizz can load API keys from environment files. Create a <code>.env</code> file in your project root:</p> <pre><code># .env\nPIXABAY_API_KEY=your_pixabay_key\nUNSPLASH_ACCESS_KEY=your_unsplash_key\nOPENAI_API_KEY=your_openai_key\n</code></pre> <p>Or set them as environment variables:</p> <pre><code>export PIXABAY_API_KEY=\"your_key\"\nexport UNSPLASH_ACCESS_KEY=\"your_key\"\nexport OPENAI_API_KEY=\"your_key\"\n</code></pre>"},{"location":"installation/#verification","title":"Verification","text":"<p>Verify your installation:</p> <pre><code>import figwizz\nprint(figwizz.__version__)\n\n# Check available functions\nprint(figwizz.__all__)\n</code></pre>"},{"location":"installation/#troubleshooting","title":"Troubleshooting","text":""},{"location":"installation/#import-errors","title":"Import Errors","text":"<p>If you encounter import errors for optional dependencies:</p> <pre><code>ImportError: No module named 'litellm'\n</code></pre> <p>Install the required optional dependency: <pre><code>pip install figwizz[genai]\n</code></pre></p>"},{"location":"installation/#permission-errors","title":"Permission Errors","text":"<p>On macOS, if AppleScript fails: 1. Grant Terminal/IDE access to System Events in System Preferences 2. Grant access to Keynote/PowerPoint in System Preferences</p>"},{"location":"installation/#libreoffice-not-found","title":"LibreOffice Not Found","text":"<p>On Linux, if presentation conversion fails: <pre><code>which soffice\n</code></pre></p> <p>If not found, install LibreOffice as shown above.</p>"},{"location":"quickstart/","title":"Quick Start","text":"<p>Get started with FigWizz in minutes! This guide covers the most common use cases.</p>"},{"location":"quickstart/#image-format-conversion","title":"Image Format Conversion","text":"<p>Convert images between formats effortlessly:</p> <pre><code>from figwizz import convert_image\n\n# Convert PNG to JPEG\nconvert_image('input.png', 'jpg')\n\n# Convert with original deletion\nconvert_image('input.png', 'pdf', delete_original=True)\n</code></pre> <p>FigWizz automatically handles transparency and color modes.</p>"},{"location":"quickstart/#creating-hexicons","title":"Creating Hexicons","text":"<p>Create tidyverse-style hexagonal icons:</p> <pre><code>from figwizz import make_hexicon\n\n# Basic hexicon\nhexicon = make_hexicon('logo.png')\nhexicon.save('hexicon.png')\n\n# With custom border\nhexicon = make_hexicon('logo.png', \n                       border_size=10, \n                       border_color='auto',  # Auto-detects contrasting color\n                       padding=20)\nhexicon.save('hexicon_bordered.png')\n\n# With position adjustment\nhexicon = make_hexicon('logo.png',\n                       shift_x=0,\n                       shift_y=-10,  # Shift up\n                       rotation=30)\n</code></pre>"},{"location":"quickstart/#working-with-stock-images","title":"Working with Stock Images","text":"<p>Download images from Pixabay or Unsplash:</p> <pre><code>from figwizz import download_stock_images\nimport os\n\n# Set API key (or use .env file)\nos.environ['UNSPLASH_ACCESS_KEY'] = 'your_key_here'\n\n# Download from Unsplash\nimages = download_stock_images(\n    query='mountains',\n    n_images=5,\n    output_dir='images',\n    provider='unsplash'\n)\n\n# Download from Pixabay\nos.environ['PIXABAY_API_KEY'] = 'your_key_here'\nimages = download_stock_images(\n    query='nature',\n    n_images=10,\n    output_dir='nature_images',\n    provider='pixabay'\n)\n</code></pre>"},{"location":"quickstart/#converting-presentations","title":"Converting Presentations","text":"<p>Convert PowerPoint or Keynote slides to images:</p> <pre><code>from figwizz import slides_to_images\n\n# Convert with auto-cropping\nslides_to_images(\n    input_path='presentation.pptx',\n    output_path='figures/',\n    filename_format='figure{:02d}.png',\n    crop_images=True,\n    margin_size='1cm',\n    dpi=300\n)\n</code></pre>"},{"location":"quickstart/#extracting-images-from-pdfs","title":"Extracting Images from PDFs","text":"<p>Extract figures from academic papers and documents:</p> <pre><code>from figwizz import extract_images_from_pdf\n\n# Extract all large images\nimages = extract_images_from_pdf(\n    pdf_path='paper.pdf',\n    output_dir='extracted_figures',\n    min_width=200,\n    min_height=200,\n    name_prefix='figure'\n)\n\nprint(f\"Extracted {len(images)} images\")\n</code></pre>"},{"location":"quickstart/#scraping-images-from-websites","title":"Scraping Images from Websites","text":"<p>Download images from web pages:</p> <pre><code>from figwizz import extract_images_from_url\n\n# Extract from URL\nimages = extract_images_from_url(\n    url='https://example.com/article',\n    output_dir='web_images',\n    min_width=400,\n    min_height=300,\n    convert_svg=True  # Convert SVG to PNG\n)\n</code></pre>"},{"location":"quickstart/#creating-image-grids","title":"Creating Image Grids","text":"<p>Display multiple images in a grid:</p> <pre><code>from figwizz import make_image_grid\nimport matplotlib.pyplot as plt\n\nimages = ['img1.png', 'img2.png', 'img3.png', 'img4.png']\ntitles = ['Image A', 'Image B', 'Image C', 'Image D']\n\nfig, axes = make_image_grid(\n    images,\n    titles=titles,\n    max_cols=2,\n    figsize=(10, 10),\n    show_index=True\n)\n\nplt.savefig('grid.png', dpi=300, bbox_inches='tight')\nplt.show()\n</code></pre>"},{"location":"quickstart/#flexible-image-input","title":"Flexible Image Input","text":"<p>FigWizz functions accept various input types:</p> <pre><code>from figwizz import make_image_opaque\nfrom PIL import Image\nimport numpy as np\n\n# From file path\nimg = make_image_opaque('image.png')\n\n# From PIL Image\npil_img = Image.open('image.png')\nimg = make_image_opaque(pil_img)\n\n# From numpy array\narr = np.random.randint(0, 256, (100, 100, 3), dtype=np.uint8)\nimg = make_image_opaque(arr)\n\n# From bytes\nwith open('image.png', 'rb') as f:\n    img_bytes = f.read()\nimg = make_image_opaque(img_bytes)\n\n# From URL\nimg = make_image_opaque('https://example.com/image.png')\n</code></pre>"},{"location":"quickstart/#n-gon-cropping","title":"N-gon Cropping","text":"<p>Create custom polygon-shaped crops:</p> <pre><code>from figwizz.modify import ngon_crop\n\n# Triangle\ntriangle = ngon_crop('image.png', sides=3)\n\n# Pentagon\npentagon = ngon_crop('image.png', sides=5)\n\n# Octagon with border\noctagon = ngon_crop('image.png', \n                    sides=8,\n                    border_size=8,\n                    border_color='#FF5733')\n</code></pre>"},{"location":"quickstart/#next-steps","title":"Next Steps","text":"<ul> <li>Explore detailed workflow guides</li> <li>Check the API reference for all available options</li> <li>See advanced examples for complex use cases</li> </ul>"},{"location":"api/reference/","title":"API Reference","text":"<p>Complete API documentation for all FigWizz modules.</p>"},{"location":"api/reference/#core-modules","title":"Core Modules","text":""},{"location":"api/reference/#convert","title":"convert","text":"<p>Image format conversion functions.</p>"},{"location":"api/reference/#figwizz.convert","title":"<code>convert</code>","text":"<p>Image format conversion utilities.</p> <p>This module provides functions for converting images between different formats, handling various input types (paths, bytes, PIL Images, etc.), and processing SVG files.</p> Example <pre><code>from figwizz.convert import convert_image\nconvert_image('input.png', 'jpg')\n# Returns: 'input.jpg'\n</code></pre>"},{"location":"api/reference/#figwizz.convert.convert_image","title":"<code>convert_image(source_path, target_format, delete_original=False)</code>","text":"<p>Convert an image file to another format.</p> <p>Supports conversion between all major image formats including PNG, JPEG, PDF, WEBP, TIFF, and more. Automatically handles transparency for formats that don't support it (like JPEG).</p> <p>Parameters:</p> Name Type Description Default <code>source_path</code> <code>str or any</code> <p>Path to the source image file, or any supported image input type (PIL Image, bytes, numpy array, URL, etc.)</p> required <code>target_format</code> <code>str</code> <p>Target format to convert to. Supported formats include: 'jpg'/'jpeg', 'png', 'pdf', 'webp', 'tiff', 'bmp', 'gif'</p> required <code>delete_original</code> <code>bool</code> <p>Whether to remove the original file after conversion. Only applies if source_path is a file path string. Defaults to False.</p> <code>False</code> <p>Returns:</p> Name Type Description <code>str</code> <p>Path to the converted image file</p> <p>Examples:</p> <pre><code>from figwizz import convert_image\n\n# Convert PNG to JPEG\nconvert_image('image.png', 'jpg')\n# Creates: image.jpg\n\n# Convert to PDF and delete original\nconvert_image('image.png', 'pdf', delete_original=True)\n# Creates: image.pdf (and deletes image.png)\n\n# Convert from URL\nconvert_image('https://example.com/image.png', 'jpg')\n</code></pre> Note <ul> <li>Automatically adds white background for JPEG/PDF (no transparency support)</li> <li>Leading dot in format is automatically handled ('jpg' or '.jpg' both work)</li> <li>For non-path inputs, creates file with default name 'converted_image.{format}'</li> <li>Output file is created in the same directory as the input file</li> </ul>"},{"location":"api/reference/#figwizz.convert.svg_to_image","title":"<code>svg_to_image(svg_content, output_path, width=None, height=None, scale=None)</code>","text":"<p>Convert SVG content to a raster image.</p> <p>Requires the optional cairosvg library for SVG conversion. This function is useful for converting vector graphics to raster formats like PNG, JPEG, or PDF while maintaining quality through scaling options.</p> <p>Parameters:</p> Name Type Description Default <code>svg_content</code> <code>bytes</code> <p>Raw SVG file content as bytes</p> required <code>output_path</code> <code>str</code> <p>Path to save the output file. File extension determines output format. Supported: .png, .jpg, .jpeg, .pdf</p> required <code>width</code> <code>int</code> <p>Output width in pixels. If None, uses SVG's natural width. Defaults to None.</p> <code>None</code> <code>height</code> <code>int</code> <p>Output height in pixels. If None, uses SVG's natural height. Defaults to None.</p> <code>None</code> <code>scale</code> <code>float</code> <p>Scale factor for the output (e.g., 2.0 for 2x resolution, 3.0 for 3x). Useful for high-DPI displays. Defaults to None.</p> <code>None</code> <p>Returns:</p> Name Type Description <code>bool</code> <p>True if conversion was successful, False if cairosvg is not installed or conversion failed</p> <p>Raises:</p> Type Description <code>ValueError</code> <p>If output_path has an unsupported file extension</p> <p>Examples:</p> <pre><code>from figwizz.convert import svg_to_image\n\n# Read SVG file\nwith open('icon.svg', 'rb') as f:\n    svg_data = f.read()\n\n# Convert to PNG with default size\nsvg_to_image(svg_data, 'icon.png')\n\n# Convert to high-resolution PNG\nsvg_to_image(svg_data, 'icon.png', scale=3.0)\n\n# Convert with specific dimensions\nsvg_to_image(svg_data, 'icon.png', width=512, height=512)\n\n# Convert to JPEG\nsvg_to_image(svg_data, 'icon.jpg', scale=2.0)\n</code></pre> Note <ul> <li>Requires cairosvg: <code>pip install cairosvg</code></li> <li>Returns False with a warning if cairosvg is not installed</li> <li>Scale and width/height can be used together</li> <li>Maintains SVG quality during conversion</li> <li>Prints informative error messages on failure</li> </ul>"},{"location":"api/reference/#modify","title":"modify","text":"<p>Image modification and transformation functions.</p>"},{"location":"api/reference/#figwizz.modify","title":"<code>modify</code>","text":"<p>Image modification and transformation utilities.</p> <p>This module provides functions for modifying images, including adding opaque backgrounds and cropping to n-sided polygon shapes (hexagons, etc.).</p> Example <pre><code>from figwizz.modify import ngon_crop, make_image_opaque\n\n# Create hexagon-shaped crop\nhexagon = ngon_crop('image.png', sides=6, border_size=5)\n\n# Make RGBA image opaque\nopaque_img = make_image_opaque(rgba_image)\n</code></pre>"},{"location":"api/reference/#figwizz.modify.make_image_opaque","title":"<code>make_image_opaque(img_input, bg_color=(255, 255, 255))</code>","text":"<p>Make an image opaque by adding a solid background color.</p> <p>Converts images with transparency (RGBA, LA) to fully opaque images by compositing them over a solid background color. Essential for formats that don't support transparency like JPEG or PDF.</p> <p>Parameters:</p> Name Type Description Default <code>img_input</code> <p>Image in any supported format (path, PIL Image, bytes, numpy array, URL, etc.). Will be normalized to PIL format automatically.</p> required <code>bg_color</code> <code>tuple</code> <p>Background color as RGB tuple (R, G, B) where each value is 0-255. Defaults to (255, 255, 255) for white.</p> <code>(255, 255, 255)</code> <p>Returns:</p> Type Description <p>PIL.Image.Image: PIL Image object in RGB mode with solid background</p> <p>Examples:</p> <pre><code>from figwizz import make_image_opaque\nfrom PIL import Image\n\n# Make PNG with transparency opaque with white background\nimg = Image.open('transparent_logo.png')\nopaque_img = make_image_opaque(img)\nopaque_img.save('opaque_logo.jpg')  # Can save as JPEG now\n\n# Use custom background color (light gray)\nopaque_img = make_image_opaque('logo.png', bg_color=(240, 240, 240))\n\n# Works with any input type\nfrom PIL import Image\nopaque_img = make_image_opaque('https://example.com/transparent.png')\n</code></pre> Note <ul> <li>Preserves original image if it has no transparency</li> <li>Automatically converts to RGB mode for consistent output</li> <li>Alpha channel is used as mask for proper compositing</li> <li>Particularly useful before converting to JPEG or PDF</li> <li>Works with both RGBA (color + alpha) and LA (grayscale + alpha) modes</li> </ul>"},{"location":"api/reference/#figwizz.modify.ngon_crop","title":"<code>ngon_crop(img_input, sides=6, crop_size=None, shift_x=0, shift_y=0, rotation=0, border_size=0, border_color='auto', padding=0, background_color=None)</code>","text":"<p>Crop an image to an n-sided polygon (n-gon), with optional border and background.</p> <p>Useful for creating tidyverse-style hexicons and other polygonal image crops.</p> <p>Parameters:</p> Name Type Description Default <code>img_input</code> <p>Image in any supported format (path, PIL Image, bytes, numpy array, etc.).</p> required <code>sides</code> <p>Number of sides of the polygon (default: 6 for hexagon).</p> <code>6</code> <code>crop_size</code> <p>Size of the output image as (width, height). If None, uses a square         based on the smallest dimension of the input image.</p> <code>None</code> <code>shift_x</code> <p>Horizontal shift in pixels (default: 0). Positive values shift right.</p> <code>0</code> <code>shift_y</code> <p>Vertical shift in pixels (default: 0). Positive values shift down.</p> <code>0</code> <code>rotation</code> <p>Rotation angle in degrees (default: 0).</p> <code>0</code> <code>border_size</code> <p>Width of the border in pixels (default: 0, no border).</p> <code>0</code> <code>border_color</code> <p>Border color. Can be: - \"auto\": Automatically select contrasting color from image - Hex code: e.g., \"#FF5733\" - RGB tuple: e.g., (255, 87, 51) - Color name: e.g., \"red\", \"blue\"</p> <code>'auto'</code> <code>padding</code> <p>Padding in pixels around the image content before cropping (default: 0).      This allows the n-gon to reshape without cutting into the image.</p> <code>0</code> <code>background_color</code> <p>Background color inside the polygon (default: None for transparent). Can be hex code, RGB tuple, or color name. Area outside polygon remains transparent.</p> <code>None</code> <p>Returns:</p> Type Description <p>PIL Image object with transparent background outside polygon and polygon crop applied.</p> <p>Examples:</p> <pre><code># Create a hexagon with auto border\nimg = ngon_crop(\"input.png\", sides=6, border_size=5, border_color=\"auto\")\n\n# Create an octagon with red border and padding\nimg = ngon_crop(\"input.png\", sides=8, border_size=3, border_color=\"red\", padding=20)\n\n# Create a pentagon with no border\nimg = ngon_crop(\"input.png\", sides=5)\n\n# Create a hexagon with white background inside\nimg = ngon_crop(\"input.png\", sides=6, background_color=\"white\")\n\n# Create a hexagon with custom background color\nimg = ngon_crop(\"input.png\", sides=6, background_color=\"#F0F0F0\")\n</code></pre>"},{"location":"api/reference/#display","title":"display","text":"<p>Functions for displaying and visualizing images.</p>"},{"location":"api/reference/#figwizz.display","title":"<code>display</code>","text":"<p>Image display and grid layout utilities.</p> <p>This module provides functions for displaying images in matplotlib-based grid layouts with customizable configurations.</p> Example <pre><code>from figwizz.display import make_image_grid\nimages = ['img1.png', 'img2.png', 'img3.png']\nfig, axes = make_image_grid(images, titles=['A', 'B', 'C'])\nplt.show()\n</code></pre>"},{"location":"api/reference/#figwizz.display.make_image_grid","title":"<code>make_image_grid(images, titles=None, max_cols=None, show_index=False, figsize=None, title_fontsize=10, show_axes=False)</code>","text":"<p>Plot a list of images in a grid layout using matplotlib.</p> <p>Creates a publication-ready grid display of images with optional titles and indexing. Automatically calculates optimal grid dimensions and figure size. Perfect for comparing multiple images, showing results, or creating figure panels for papers and presentations.</p> <p>Parameters:</p> Name Type Description Default <code>images</code> <code>list</code> <p>List of images in any supported format (paths, PIL Images, bytes, numpy arrays, URLs, etc.). All images will be normalized to PIL format automatically.</p> required <code>titles</code> <code>list[str]</code> <p>List of titles for each image. Length should match the number of images. Defaults to None.</p> <code>None</code> <code>max_cols</code> <code>int</code> <p>Maximum number of columns in the grid. If None, defaults to min(4, number_of_images). Defaults to None.</p> <code>None</code> <code>show_index</code> <code>bool</code> <p>If True, shows \"Image N\" label in the corner of each subplot. Defaults to False.</p> <code>False</code> <code>figsize</code> <code>tuple</code> <p>Figure size as (width, height) in inches. If None, automatically calculated as (max_cols3, num_rows3). Defaults to None.</p> <code>None</code> <code>title_fontsize</code> <code>int</code> <p>Font size for image titles in points. Defaults to 10.</p> <code>10</code> <code>show_axes</code> <code>bool</code> <p>If True, shows axes with tick marks around each image. If False, axes are hidden for a cleaner look. Defaults to False.</p> <code>False</code> <p>Returns:</p> Name Type Description <code>tuple</code> <p>(fig, axes) - Matplotlib Figure and Axes objects that can be further customized or saved. Returns (None, None) if images list is empty.</p> <p>Examples:</p> <pre><code>from figwizz import make_image_grid\nimport matplotlib.pyplot as plt\n\n# Simple grid of images\nimages = ['img1.png', 'img2.png', 'img3.png', 'img4.png']\nfig, axes = make_image_grid(images)\nplt.show()\n\n# Grid with titles and custom columns\nfig, axes = make_image_grid(\n    images,\n    titles=['Original', 'Processed', 'Enhanced', 'Final'],\n    max_cols=2\n)\nplt.savefig('comparison.png', dpi=300, bbox_inches='tight')\n\n# Grid with image indices\nfig, axes = make_image_grid(\n    images,\n    show_index=True,\n    figsize=(12, 8)\n)\n\n# Mix different input types\nmixed_images = [\n    'local_image.png',\n    'https://example.com/image.jpg',\n    pil_image_object,\n    numpy_array\n]\nfig, axes = make_image_grid(mixed_images)\n</code></pre> Note <ul> <li>Empty image list returns (None, None)</li> <li>Grid dimensions are automatically calculated for optimal layout</li> <li>Unused subplots (when images don't fill the grid) are hidden</li> <li>All images are normalized to PIL format internally</li> <li>Figure can be saved with plt.savefig() or displayed with plt.show()</li> <li>Axes are hidden by default for cleaner appearance</li> <li>Index labels appear with semi-transparent background for readability</li> </ul>"},{"location":"api/reference/#scrape","title":"scrape","text":"<p>Web scraping and image extraction from URLs and PDFs.</p>"},{"location":"api/reference/#figwizz.scrape","title":"<code>scrape</code>","text":"<p>Figure and image scraping utilities.</p> <p>This module provides functions for downloading images from various sources including: - Stock image providers (Pixabay, Unsplash) - PDF documents (local files or URLs) - Web pages (extracting embedded images)</p> <p>Supports automatic metadata collection and handles various image formats including raster images (PNG, JPEG) and vector graphics (SVG with optional conversion).</p> Example <pre><code>from figwizz import download_stock_images, extract_images_from_pdf\n\n# Download stock images\nimages = download_stock_images('mountains', 5, 'output/')\n\n# Extract from PDF\nextract_images_from_pdf('paper.pdf', 'figures/')\n</code></pre>"},{"location":"api/reference/#figwizz.scrape.download_pdf_from_url","title":"<code>download_pdf_from_url(url)</code>","text":"<p>Download a PDF from a URL to a temporary file.</p> <p>Parameters:</p> Name Type Description Default <code>url</code> <p>URL of the PDF file</p> required <p>Returns:</p> Type Description <p>Path to the temporary PDF file</p>"},{"location":"api/reference/#figwizz.scrape.download_pixabay_images","title":"<code>download_pixabay_images(query, n_images, output_dir, api_key=None)</code>","text":"<p>Download images from Pixabay API.</p> <p>This function queries the Pixabay API for images matching the search query and downloads high-resolution versions along with comprehensive metadata.</p> <p>Parameters:</p> Name Type Description Default <code>query</code> <code>str</code> <p>Search query string to find images on Pixabay</p> required <code>n_images</code> <code>int</code> <p>Maximum number of images to download (up to 200 per request)</p> required <code>output_dir</code> <code>str</code> <p>Directory path where images and metadata will be saved</p> required <code>api_key</code> <code>str</code> <p>Pixabay API key. If None, reads from PIXABAY_API_KEY environment variable. Defaults to None.</p> <code>None</code> <p>Returns:</p> Name Type Description <code>list</code> <p>List of paths to successfully downloaded images</p> <p>Raises:</p> Type Description <code>ValueError</code> <p>If PIXABAY_API_KEY is not set and api_key is None</p> <code>RuntimeError</code> <p>If API request fails or returns unexpected format</p> <p>Examples:</p> <pre><code>from figwizz.scrape import download_pixabay_images\n\n# Download 10 nature images\nimages = download_pixabay_images('nature', 10, 'pixabay_images')\nprint(f\"Downloaded {len(images)} images\")\n</code></pre> Note <ul> <li>Images are downloaded in 'largeImageURL' format (typically 1280px width)</li> <li>Metadata includes image URL, dimensions, tags, user info, and more</li> <li>Sequential numbering continues from existing images in the directory</li> <li>Failed downloads are skipped with a warning message</li> </ul>"},{"location":"api/reference/#figwizz.scrape.download_stock_images","title":"<code>download_stock_images(query, n_images, output_dir, provider='pixabay', api_key=None)</code>","text":"<p>Download stock images from various providers (Pixabay or Unsplash).</p> <p>This function provides a unified interface for downloading stock images from multiple providers. Each downloaded image is saved with accompanying metadata in JSON format.</p> <p>Parameters:</p> Name Type Description Default <code>query</code> <code>str</code> <p>Search query string to find images</p> required <code>n_images</code> <code>int</code> <p>Number of images to download</p> required <code>output_dir</code> <code>str</code> <p>Directory path where images and metadata will be saved</p> required <code>provider</code> <code>str</code> <p>Image provider to use. Options: 'pixabay' or 'unsplash'. Defaults to 'pixabay'.</p> <code>'pixabay'</code> <code>api_key</code> <code>str</code> <p>API key for the selected provider. If None, attempts to read from environment variables (PIXABAY_API_KEY or UNSPLASH_ACCESS_KEY). Defaults to None.</p> <code>None</code> <p>Returns:</p> Name Type Description <code>list</code> <p>List of paths to successfully downloaded images</p> <p>Raises:</p> Type Description <code>ValueError</code> <p>If provider is not 'pixabay' or 'unsplash'</p> <code>ValueError</code> <p>If API key is not provided and not found in environment</p> <code>RuntimeError</code> <p>If API request fails or returns unexpected format</p> <p>Examples:</p> <pre><code>from figwizz import download_stock_images\n\n# Download 5 images of mountains from Pixabay\nimages = download_stock_images('mountains', 5, 'output/mountains')\n\n# Download from Unsplash with explicit API key\nimages = download_stock_images(\n    'sunset', 10, 'output/sunsets',\n    provider='unsplash',\n    api_key='your_api_key_here'\n)\n</code></pre> Note <ul> <li>Each image is saved as a .jpg file with a sequential name (e.g., image_1.jpg)</li> <li>Metadata for each image is saved in a corresponding .json file</li> <li>If the output directory already contains images, numbering continues from the last image</li> <li>Requires valid API keys from the respective providers (Pixabay or Unsplash)</li> </ul>"},{"location":"api/reference/#figwizz.scrape.download_unsplash_images","title":"<code>download_unsplash_images(query, n_images, output_dir, api_key=None)</code>","text":"<p>Download images from Unsplash API.</p> <p>This function queries the Unsplash API for images matching the search query and downloads full-resolution versions along with photographer attribution and comprehensive metadata.</p> <p>Parameters:</p> Name Type Description Default <code>query</code> <code>str</code> <p>Search query string to find images on Unsplash</p> required <code>n_images</code> <code>int</code> <p>Maximum number of images to download (up to 30 per request)</p> required <code>output_dir</code> <code>str</code> <p>Directory path where images and metadata will be saved</p> required <code>api_key</code> <code>str</code> <p>Unsplash Access Key. If None, reads from UNSPLASH_ACCESS_KEY environment variable. Defaults to None.</p> <code>None</code> <p>Returns:</p> Name Type Description <code>list</code> <p>List of paths to successfully downloaded images</p> <p>Raises:</p> Type Description <code>ValueError</code> <p>If UNSPLASH_ACCESS_KEY is not set and api_key is None</p> <code>RuntimeError</code> <p>If API request fails or returns unexpected format</p> <p>Examples:</p> <pre><code>from figwizz.scrape import download_unsplash_images\n\n# Download 5 landscape photos\nimages = download_unsplash_images('landscape', 5, 'unsplash_images')\n</code></pre> Note <ul> <li>Images are downloaded in 'full' resolution (highest quality available)</li> <li>Metadata includes photographer attribution, description, tags, likes, and more</li> <li>Sequential numbering continues from existing images in the directory</li> <li>Failed downloads are skipped with a warning message</li> <li>Please respect Unsplash's API guidelines and attribution requirements</li> </ul>"},{"location":"api/reference/#figwizz.scrape.extract_images_from_pdf","title":"<code>extract_images_from_pdf(pdf_path, output_dir, min_width=100, min_height=100, name_prefix='figure')</code>","text":"<p>Extract images from a PDF file.</p> <p>Parameters:</p> Name Type Description Default <code>pdf_path</code> <p>Path to the PDF file</p> required <code>output_dir</code> <p>Directory to save extracted images</p> required <code>min_width</code> <p>Minimum image width to keep (filters out small icons)</p> <code>100</code> <code>min_height</code> <p>Minimum image height to keep (filters out small icons)</p> <code>100</code> <code>name_prefix</code> <p>Prefix for saved image filenames</p> <code>'figure'</code> <p>Returns:</p> Type Description <p>List of saved image paths</p>"},{"location":"api/reference/#figwizz.scrape.extract_images_from_url","title":"<code>extract_images_from_url(url, output_dir, min_width=100, min_height=100, name_prefix='figure', convert_svg=False, svg_scale=3.0)</code>","text":"<p>Extract images from a web page URL.</p> <p>Parameters:</p> Name Type Description Default <code>url</code> <p>URL of the web page</p> required <code>output_dir</code> <p>Directory to save downloaded images</p> required <code>min_width</code> <p>Minimum image width to keep</p> <code>100</code> <code>min_height</code> <p>Minimum image height to keep</p> <code>100</code> <code>name_prefix</code> <p>Prefix for saved image filenames</p> <code>'figure'</code> <code>convert_svg</code> <p>Whether to convert SVG files to PNG</p> <code>False</code> <code>svg_scale</code> <p>Scale factor for SVG to PNG conversion (default: 3.0 for high quality)</p> <code>3.0</code> <p>Returns:</p> Type Description <p>List of saved image paths</p>"},{"location":"api/reference/#generate","title":"generate","text":"<p>AI-powered image generation using various models.</p>"},{"location":"api/reference/#figwizz.generate","title":"<code>generate</code>","text":"<p>Image generation with generative AI models.</p> <p>This module provides functions for generating images using AI models through the litellm library. Requires optional dependency: litellm.</p> Example <pre><code>from figwizz.generate import generate_images\nprompts = [\"a red apple\", \"a blue ocean\"]\nimages = generate_images(prompts, output_dir=\"generated\")\n</code></pre>"},{"location":"api/reference/#figwizz.generate.extract_image_data","title":"<code>extract_image_data(response)</code>","text":"<p>Extract image data from a generative AI response.</p> <p>This is a convenience wrapper around extract_image_from_genai_response. It handles various response formats from different AI providers.</p> <p>Parameters:</p> Name Type Description Default <code>response</code> <code>Any</code> <p>The response object from a generative AI model (e.g., OpenAI, Google, OpenRouter). Can be a dictionary or custom response object.</p> required <p>Returns:</p> Type Description <code>tuple[bytes, Dict[str, Any]]</code> <p>tuple[bytes, dict]: A tuple containing: - bytes: Raw image data ready to be saved - dict: Metadata about the extraction method and format</p> <p>Examples:</p> <pre><code>from figwizz.generate import extract_image_data\nfrom litellm import image_generation\n\n# Generate image\nresponse = image_generation(prompt=\"a sunset\", model=\"gpt-image-1\")\n\n# Extract image bytes\nimage_bytes, metadata = extract_image_data(response)\n\n# Save to file\nwith open('sunset.png', 'wb') as f:\n    f.write(image_bytes)\n</code></pre> Note <ul> <li>Supports base64 and URL-based image responses</li> <li>Automatically handles various AI provider response formats</li> <li>See extract_image_from_genai_response for detailed format support</li> </ul>"},{"location":"api/reference/#figwizz.generate.generate_images","title":"<code>generate_images(prompts, output_dir, n_images=1, model='gpt-image-1', api_key=None, return_images=True)</code>","text":"<p>Generate images from text prompts using generative AI models.</p> <p>Uses the litellm library to generate images from various AI providers including OpenAI, Google, and OpenRouter. Each generated image is saved with comprehensive metadata including the prompt, model, timestamp, and API response details.</p> <p>Parameters:</p> Name Type Description Default <code>prompts</code> <code>str or list[str]</code> <p>Text prompt(s) describing the desired image(s). Can be a single string or a list of strings for batch generation.</p> required <code>output_dir</code> <code>str</code> <p>Directory where generated images and metadata will be saved. Created automatically if it doesn't exist.</p> required <code>n_images</code> <code>int</code> <p>Number of images to generate for each prompt. Defaults to 1.</p> <code>1</code> <code>model</code> <code>str</code> <p>Model identifier for image generation. Common options: - 'gpt-image-1' (OpenAI DALL-E) - 'dall-e-3' (OpenAI DALL-E 3) - 'dall-e-2' (OpenAI DALL-E 2) Defaults to 'gpt-image-1'.</p> <code>'gpt-image-1'</code> <code>api_key</code> <code>str</code> <p>API key for the AI service. If None, reads from OPENAI_API_KEY environment variable. Defaults to None.</p> <code>None</code> <code>return_images</code> <code>bool</code> <p>If True, returns list of PIL Image objects. If False, only saves images and returns None. Defaults to True.</p> <code>True</code> <p>Returns:</p> Type Description <p>list[PIL.Image.Image] or None: List of PIL Image objects if return_images=True, otherwise None</p> <p>Raises:</p> Type Description <code>ImportError</code> <p>If litellm is not installed</p> <code>ValueError</code> <p>If OPENAI_API_KEY is not set and api_key is None</p> <p>Examples:</p> <pre><code>from figwizz import generate_images\n\n# Generate a single image\nimages = generate_images(\n    \"a serene mountain landscape at sunset\",\n    output_dir=\"generated_images\"\n)\nimages[0].show()\n\n# Generate multiple images from multiple prompts\nprompts = [\n    \"a red apple on a wooden table\",\n    \"a blue ocean with white clouds\",\n    \"a futuristic city at night\"\n]\nimages = generate_images(\n    prompts,\n    output_dir=\"ai_art\",\n    n_images=2,  # 2 variations per prompt\n    model=\"dall-e-3\"\n)\n\n# Generate without returning images (saves memory)\ngenerate_images(\n    prompts,\n    output_dir=\"batch_output\",\n    return_images=False\n)\n</code></pre> Note <ul> <li>Requires litellm: <code>pip install litellm</code> or <code>pip install 'figwizz[genai]'</code></li> <li>Each prompt creates a subdirectory named after the prompt (sanitized)</li> <li>For each image, saves:</li> <li>image_N.png - The generated image</li> <li>image_N_response.json - Full API response</li> <li>image_N_metadata.json - Curated metadata (prompt, model, timestamp, etc.)</li> <li>Failed generations are skipped with error messages</li> <li>Progress is displayed via tqdm progress bars</li> <li>Image numbering continues from existing images in subdirectories</li> <li>Prompt text is sanitized for use in directory names (removes special chars)</li> </ul>"},{"location":"api/reference/#stitchkit","title":"stitchkit","text":"<p>Presentation processing and PDF stitching utilities.</p>"},{"location":"api/reference/#figwizz.stitchkit","title":"<code>stitchkit</code>","text":"<p>Slide conversion and PDF stitching utilities.</p> <p>This module provides functions for converting presentation slides (PowerPoint, Keynote) to images and PDFs, with support for whitespace cropping and batch processing.</p> Platform Support <ul> <li>macOS: Uses AppleScript for Keynote and PowerPoint</li> <li>Windows: Uses COM interface for PowerPoint</li> <li>Linux: Uses LibreOffice command-line tools</li> </ul> Example <pre><code>from figwizz.stitchkit import slides_to_images\nslides_to_images('presentation.pptx', 'output_folder', crop_images=True)\n</code></pre>"},{"location":"api/reference/#figwizz.stitchkit.convert_images_to_pdf","title":"<code>convert_images_to_pdf(input_path, dpi=300, **kwargs)</code>","text":"<p>Convert all images in a directory and its subdirectories to PDF files.</p> <p>Recursively searches through all subdirectories and converts every PNG, JPEG, and TIFF image to PDF format. Useful for batch processing entire folder structures.</p> <p>Parameters:</p> Name Type Description Default <code>input_path</code> <code>str</code> <p>Path to the root directory containing images. All subdirectories will be searched recursively.</p> required <code>dpi</code> <code>int</code> <p>DPI (dots per inch) for all output PDF files. Defaults to 300.</p> <code>300</code> <code>**kwargs</code> <p>Additional keyword arguments passed to convert_to_pdf: - pdf_only (bool): If True, removes original image files after conversion.   Defaults to False.</p> <code>{}</code> <p>Examples:</p> <pre><code>from figwizz.stitchkit import convert_images_to_pdf\n\n# Convert all images in directory tree\nconvert_images_to_pdf('project_figures/')\n\n# High-resolution conversion\nconvert_images_to_pdf('images/', dpi=600)\n\n# Convert and remove originals\nconvert_images_to_pdf('temp_images/', pdf_only=True)\n</code></pre> Note <ul> <li>Searches recursively through all subdirectories</li> <li>Supported formats: PNG, JPG, JPEG, TIFF, TIF</li> <li>Each image is converted in its current location</li> <li>PDF files are created alongside original images</li> <li>Use pdf_only=True with caution as it deletes original images</li> <li>Does not follow symbolic links</li> </ul>"},{"location":"api/reference/#figwizz.stitchkit.convert_to_pdf","title":"<code>convert_to_pdf(image_path, output_path=None, dpi=300, **kwargs)</code>","text":"<p>Convert PNG, JPEG, or TIFF images to high-quality PDF files.</p> <p>Creates publication-quality PDF files from raster images with specified resolution. Automatically handles transparency by adding white backgrounds where needed.</p> <p>Parameters:</p> Name Type Description Default <code>image_path</code> <code>str</code> <p>Path to an image file or a directory containing image files. Supported formats: PNG, JPG, JPEG, TIFF, TIF</p> required <code>output_path</code> <code>str</code> <p>Path where the PDF files will be saved. - If None, uses same location as input with .pdf extension - For single files, specify output file path - For directories, processes all images in place Defaults to None.</p> <code>None</code> <code>dpi</code> <code>int</code> <p>DPI (dots per inch) for the output PDF. Common values: - 72: screen resolution (smallest file size) - 150: draft print quality - 300: standard print quality (default) - 600: high-quality print Defaults to 300.</p> <code>300</code> <code>**kwargs</code> <p>Additional keyword arguments: - pdf_only (bool): If True, removes original image files after conversion.   Defaults to False.</p> <code>{}</code> <p>Returns:</p> Type Description <p>None</p> <p>Examples:</p> <pre><code>from figwizz.stitchkit import convert_to_pdf\n\n# Convert single image\nconvert_to_pdf('figure.png')  # Creates figure.pdf\n\n# Convert with custom output path\nconvert_to_pdf('image.jpg', 'document.pdf')\n\n# Convert all images in directory\nconvert_to_pdf('figures_folder/')\n\n# High-resolution PDF\nconvert_to_pdf('figure.png', dpi=600)\n\n# Convert and delete original\nconvert_to_pdf('image.png', pdf_only=True)\n\n# Batch convert to new directory\nconvert_to_pdf('input_images/', 'pdf_output/')\n</code></pre> Note <ul> <li>Automatically converts RGBA/LA images to RGB with white background</li> <li>Preserves image quality and dimensions</li> <li>PDF resolution is embedded in the file</li> <li>When processing directories, converts each image to PDF with same filename</li> <li>Output directory is created if it doesn't exist</li> <li>Use pdf_only=True with caution as it deletes original images</li> </ul>"},{"location":"api/reference/#figwizz.stitchkit.crop_whitespace","title":"<code>crop_whitespace(image_path, output_path=None, margin_size='1cm', dpi=300)</code>","text":"<p>Crop whitespace around images and add a specified margin.</p> <p>Intelligently removes white borders and backgrounds from images while preserving the important content. Optionally adds a clean margin around the cropped content. Perfect for cleaning up screenshots, slides, or figures with excess whitespace.</p> <p>Parameters:</p> Name Type Description Default <code>image_path</code> <code>str</code> <p>Path to an image file or a directory containing image files. If a directory, processes all PNG, JPG, and JPEG files within it.</p> required <code>output_path</code> <code>str</code> <p>Path where cropped images will be saved.  - If None, overwrites the original files - For single files, specify output file path - For directories, specify output directory path Defaults to None.</p> <code>None</code> <code>margin_size</code> <code>str</code> <p>Margin to add around cropped content (e.g., '1cm', '0.5cm', '2cm'). Converted to pixels based on DPI. Defaults to '1cm'.</p> <code>'1cm'</code> <code>dpi</code> <code>int</code> <p>DPI (dots per inch) for margin calculation. Standard values: - 72: screen resolution - 150: draft print quality - 300: standard print quality (default) - 600: high-quality print Defaults to 300.</p> <code>300</code> <p>Examples:</p> <pre><code>from figwizz.stitchkit import crop_whitespace\n\n# Crop single image with default 1cm margin\ncrop_whitespace('screenshot.png')  # Overwrites original\n\n# Crop and save to new file\ncrop_whitespace('slide.png', 'cropped_slide.png')\n\n# Crop all images in directory\ncrop_whitespace('slides_folder/')\n\n# Custom margin and DPI\ncrop_whitespace(\n    'figures/',\n    output_path='cropped_figures/',\n    margin_size='2cm',\n    dpi=600\n)\n\n# No margin (tight crop)\ncrop_whitespace('image.png', margin_size='0cm')\n</code></pre> Note <ul> <li>Uses intelligent bounding box detection to find content</li> <li>Converts RGBA images to RGB with white background before cropping</li> <li>Margin size is converted from centimeters to pixels: pixels = (cm * dpi) / 2.54</li> <li>When processing directories, preserves original filenames</li> <li>Supports PNG, JPG, and JPEG formats</li> <li>Creates output directory if it doesn't exist</li> <li>Original images are preserved if output_path is specified</li> </ul>"},{"location":"api/reference/#figwizz.stitchkit.keynote_to_images","title":"<code>keynote_to_images(input_path, output_path, filename_format='figure{:01d}.png')</code>","text":"<p>Convert Keynote slides to image files using AppleScript.</p> <p>Uses macOS AppleScript automation to export all slides from a Keynote presentation as individual PNG images. This is the native method for Keynote conversion on macOS.</p> <p>Parameters:</p> Name Type Description Default <code>input_path</code> <code>str</code> <p>Path to the Keynote (.key) file</p> required <code>output_path</code> <code>str</code> <p>Directory path where the images will be saved. Created automatically if it doesn't exist.</p> required <code>filename_format</code> <code>str</code> <p>Python format string for output filenames. Must include a placeholder for slide number. Defaults to 'figure{:01d}.png'.</p> <code>'figure{:01d}.png'</code> <p>Examples:</p> <pre><code>from figwizz.stitchkit import keynote_to_images\n\n# Convert Keynote to images\nkeynote_to_images('presentation.key', 'slides/')\n\n# Custom filename format\nkeynote_to_images(\n    'deck.key',\n    'output/',\n    filename_format='slide_{:03d}.png'\n)\n</code></pre> Note <ul> <li>macOS only: Requires Keynote to be installed</li> <li>Uses AppleScript automation via osascript command</li> <li>Keynote application will briefly open during conversion</li> <li>All slides are exported, including hidden/skipped slides</li> <li>Images are exported in PNG format with transparency</li> <li>Source: https://iworkautomation.com/keynote/document-export.html</li> </ul> <p>Raises:</p> Type Description <code>SystemError</code> <p>If run on non-macOS platform</p> <code>FileNotFoundError</code> <p>If Keynote is not installed</p>"},{"location":"api/reference/#figwizz.stitchkit.mogrify_images_to_pdf","title":"<code>mogrify_images_to_pdf(input_path, **kwargs)</code>","text":"<p>Convert images to PDF using ImageMagick's mogrify command.</p> <p>Alternative to convert_images_to_pdf that uses ImageMagick for conversion. Provides high-quality conversion with ImageMagick's robust processing engine. Recursively processes all images in subdirectories.</p> <p>Parameters:</p> Name Type Description Default <code>input_path</code> <code>str</code> <p>Path to the directory containing images. All subdirectories will be searched recursively.</p> required <code>**kwargs</code> <p>Additional keyword arguments: - pdf_only (bool): If True, removes original image files after conversion.   Defaults to False.</p> <code>{}</code> <p>Examples:</p> <pre><code>from figwizz.stitchkit import mogrify_images_to_pdf\n\n# Convert using ImageMagick\nmogrify_images_to_pdf('figures/')\n\n# Convert and remove originals\nmogrify_images_to_pdf('temp_images/', pdf_only=True)\n</code></pre> Note <ul> <li>Requires ImageMagick: Install with:</li> <li>macOS: <code>brew install imagemagick</code></li> <li>Ubuntu/Debian: <code>sudo apt install imagemagick</code></li> <li>Windows: Download from https://imagemagick.org</li> <li>Uses fixed settings: quality=100, density=300 DPI</li> <li>Searches recursively through all subdirectories</li> <li>Supported formats: PNG, JPG, JPEG, TIFF, TIF</li> <li>Each image is converted in its current location</li> <li>Generally faster than PIL-based conversion for large batches</li> <li>Use pdf_only=True with caution as it deletes original images</li> </ul> <p>Raises:</p> Type Description <code>FileNotFoundError</code> <p>If ImageMagick's mogrify command is not found in PATH</p> <code>CalledProcessError</code> <p>If mogrify command fails</p>"},{"location":"api/reference/#figwizz.stitchkit.powerpoint_to_images","title":"<code>powerpoint_to_images(input_path, output_path, filename_format='figure{:01d}.png')</code>","text":"<p>Convert PowerPoint slides to image files.</p> <p>Platform-aware conversion that automatically uses the best method available for your operating system. Exports all slides from PowerPoint presentations (.ppt, .pptx) as individual PNG images.</p> <p>Parameters:</p> Name Type Description Default <code>input_path</code> <code>str</code> <p>Path to the PowerPoint file (.ppt or .pptx)</p> required <code>output_path</code> <code>str</code> <p>Directory path where the images will be saved. Created automatically if it doesn't exist.</p> required <code>filename_format</code> <code>str</code> <p>Python format string for output filenames. Must include a placeholder for slide number. Defaults to 'figure{:01d}.png'.</p> <code>'figure{:01d}.png'</code> <p>Examples:</p> <pre><code>from figwizz.stitchkit import powerpoint_to_images\n\n# Convert PowerPoint to images\npowerpoint_to_images('presentation.pptx', 'slides/')\n\n# Custom filename format\npowerpoint_to_images(\n    'deck.pptx',\n    'output/',\n    filename_format='slide_{:03d}.png'\n)\n</code></pre> Platform-specific behavior <p>macOS: - Uses AppleScript with Microsoft PowerPoint - Requires PowerPoint for Mac to be installed - PowerPoint will briefly open during conversion</p> <p>Windows: - Uses COM interface via win32com.client - Requires PowerPoint and pywin32: <code>pip install pywin32</code> - PowerPoint runs in background (visible)</p> <p>Linux/Other: - Uses LibreOffice command-line interface - Requires LibreOffice: <code>sudo apt install libreoffice</code> - Falls back to python-pptx with limited functionality</p> Note <ul> <li>All slides are exported, including hidden/skipped slides</li> <li>Images are exported in PNG format</li> <li>Original slide dimensions are preserved</li> <li>Output directory is created if it doesn't exist</li> <li>Existing images with same names are overwritten</li> </ul> <p>Raises:</p> Type Description <code>ImportError</code> <p>If required libraries (pywin32, python-pptx) are not installed</p> <code>FileNotFoundError</code> <p>If PowerPoint/LibreOffice is not found</p> <code>CalledProcessError</code> <p>If LibreOffice conversion fails</p>"},{"location":"api/reference/#figwizz.stitchkit.reformat_image_filenames","title":"<code>reformat_image_filenames(output_path, reformat_pattern)</code>","text":"<p>Rename image files based on a specified pattern.</p> <p>Renames all PNG files in a directory to follow a consistent naming pattern. Extracts existing numbers from filenames and applies the new format.</p> <p>Parameters:</p> Name Type Description Default <code>output_path</code> <code>str</code> <p>Directory containing the PNG image files to rename</p> required <code>reformat_pattern</code> <code>str</code> <p>Python format string for new filenames (e.g., 'figure{:01d}.png' or 'slide_{:03d}.png'). Must contain a numeric placeholder that will be filled with the extracted slide/image number.</p> required <p>Examples:</p> <pre><code>from figwizz.stitchkit import reformat_image_filenames\n\n# Rename Slide1.png, Slide2.png, etc. to figure1.png, figure2.png\nreformat_image_filenames('slides/', 'figure{:01d}.png')\n\n# Rename to zero-padded format: img001.png, img002.png, etc.\nreformat_image_filenames('images/', 'img{:03d}.png')\n</code></pre> Note <ul> <li>Only processes PNG files</li> <li>Extracts the first numeric value found in each filename</li> <li>Files are renamed in place within the same directory</li> <li>Original files are overwritten with new names</li> <li>Useful after slides_to_images to standardize naming</li> </ul>"},{"location":"api/reference/#figwizz.stitchkit.slides_to_images","title":"<code>slides_to_images(input_path, output_path, filename_format='figure{:01d}.png', crop_images=True, margin_size='1cm', dpi=300)</code>","text":"<p>Convert presentation slides to image files.</p> <p>Extracts all slides from PowerPoint (.ppt, .pptx) or Keynote (.key) presentations as individual PNG images. Automatically detects the presentation format and uses platform-appropriate tools for conversion. Optionally crops whitespace and adds margins for professional-looking figures.</p> <p>Parameters:</p> Name Type Description Default <code>input_path</code> <code>str</code> <p>Path to the presentation file. Supported formats: - PowerPoint: .ppt, .pptx - Keynote: .key (macOS only)</p> required <code>output_path</code> <code>str</code> <p>Directory path where the images will be saved. Created automatically if it doesn't exist.</p> required <code>filename_format</code> <code>str</code> <p>Python format string for output filenames. Must include a placeholder for slide number (e.g., '{:01d}' for 1-digit, '{:03d}' for 3-digit with leading zeros). Defaults to 'figure{:01d}.png'.</p> <code>'figure{:01d}.png'</code> <code>crop_images</code> <code>bool</code> <p>If True, removes whitespace around slides and adds specified margin. If False, keeps original slide dimensions. Defaults to True.</p> <code>True</code> <code>margin_size</code> <code>str</code> <p>Margin to add around cropped slides (e.g., '1cm', '0.5cm', '2cm'). Only used when crop_images=True. Defaults to '1cm'.</p> <code>'1cm'</code> <code>dpi</code> <code>int</code> <p>Resolution for output images in dots per inch. Higher values produce larger, higher-quality images. Defaults to 300.</p> <code>300</code> <p>Examples:</p> <pre><code>from figwizz import slides_to_images\n\n# Basic conversion\nslides_to_images('presentation.pptx', 'output_slides/')\n\n# Without cropping\nslides_to_images('slides.pptx', 'figures/', crop_images=False)\n\n# Custom filename format with 3-digit numbering\nslides_to_images(\n    'deck.key',\n    'keynote_slides/',\n    filename_format='slide_{:03d}.png'\n)\n\n# High resolution with custom margin\nslides_to_images(\n    'presentation.pptx',\n    'high_res_figures/',\n    margin_size='2cm',\n    dpi=600\n)\n</code></pre> Note <p>Platform compatibility: - macOS: Supports both PowerPoint (.ppt, .pptx) and Keynote (.key)   Uses AppleScript for automation - Windows: Supports PowerPoint (.ppt, .pptx) only   Uses COM interface (pywin32 required) - Linux: Supports PowerPoint via LibreOffice   Requires LibreOffice installed</p> <p>Additional notes: - Output directory is created if it doesn't exist - Existing images with same names are overwritten - Cropping uses intelligent whitespace detection - Margin size is converted to pixels using the specified DPI - Progress is shown for multi-step operations</p>"},{"location":"api/reference/#supporting-modules","title":"Supporting Modules","text":""},{"location":"api/reference/#colors","title":"colors","text":"<p>Color manipulation and analysis utilities.</p>"},{"location":"api/reference/#figwizz.colors","title":"<code>colors</code>","text":"<p>Color processing utilities for FigWizz.</p> <p>This module provides functions for parsing, extracting, and manipulating colors in images. It supports multiple color input formats and provides intelligent color analysis for automatic color selection.</p> <p>Key features: - Parse colors from multiple formats (hex, RGB, color names) - Extract dominant colors from images - Generate contrasting colors for borders and text</p> Example <pre><code>from figwizz.colors import parse_color, extract_dominant_color, get_contrasting_color\nfrom PIL import Image\n\n# Parse different color formats\nrgb = parse_color('#FF5733')\nrgb = parse_color('red')\nrgb = parse_color((255, 87, 51))\n\n# Extract dominant color from image\nimg = Image.open('image.png')\ndominant = extract_dominant_color(img)\n\n# Get contrasting color\ncontrast = get_contrasting_color(dominant)\n</code></pre>"},{"location":"api/reference/#figwizz.colors.extract_dominant_color","title":"<code>extract_dominant_color(img, num_colors=5)</code>","text":"<p>Extract the dominant color from an image using color quantization.</p> <p>Uses color quantization to reduce the image to a small palette and then identifies the most frequent color, excluding very light colors that are likely backgrounds.</p> <p>Parameters:</p> Name Type Description Default <code>img</code> <code>Image</code> <p>PIL Image object to analyze</p> required <code>num_colors</code> <code>int</code> <p>Number of colors to quantize to. Higher values provide more precision but slower processing. Defaults to 5.</p> <code>5</code> <p>Returns:</p> Name Type Description <code>tuple</code> <p>RGB tuple (R, G, B) of the dominant color, where each value is in range 0-255</p> <p>Examples:</p> <pre><code>from figwizz.colors import extract_dominant_color\nfrom PIL import Image\n\nimg = Image.open('photo.jpg')\ndominant = extract_dominant_color(img)\nprint(f\"Dominant color: RGB{dominant}\")\n\n# Use more colors for better precision\ndominant = extract_dominant_color(img, num_colors=10)\n</code></pre> Note <ul> <li>Image is resized to 100x100 for faster processing</li> <li>Very light colors (potential backgrounds) are automatically skipped</li> <li>Returns the most frequent color after filtering</li> </ul>"},{"location":"api/reference/#figwizz.colors.get_contrasting_color","title":"<code>get_contrasting_color(rgb, prefer_dark=True)</code>","text":"<p>Generate a contrasting color for the given RGB color.</p> <p>Uses relative luminance calculation to determine if the input color is light or dark, then generates an appropriate contrasting color. Useful for creating borders, text overlays, or UI elements that need to stand out against an image.</p> <p>Parameters:</p> Name Type Description Default <code>rgb</code> <code>tuple</code> <p>RGB tuple (R, G, B) where each value is in range 0-255</p> required <code>prefer_dark</code> <code>bool</code> <p>If True, prefers dark contrasting colors even for dark inputs (creating darker shades). If False, uses pure black/white contrast. Defaults to True.</p> <code>True</code> <p>Returns:</p> Name Type Description <code>tuple</code> <p>RGB tuple (R, G, B) of the contrasting color</p> <p>Examples:</p> <pre><code>from figwizz.colors import get_contrasting_color\n\n# Get contrast for a light color (returns dark)\ncontrast = get_contrasting_color((200, 200, 200))\n# Returns: (40, 40, 40)\n\n# Get contrast for a dark color with prefer_dark=False\ncontrast = get_contrasting_color((50, 50, 50), prefer_dark=False)\n# Returns: (255, 255, 255)\n\n# Use with extracted dominant color\nfrom figwizz.colors import extract_dominant_color\ndominant = extract_dominant_color(img)\nborder_color = get_contrasting_color(dominant)\n</code></pre> Note <ul> <li>Uses standard relative luminance formula (0.299R + 0.587G + 0.114*B)</li> <li>When prefer_dark=True, creates darker/more saturated versions for dark inputs</li> <li>When prefer_dark=False, returns pure black (0,0,0) or white (255,255,255)</li> </ul>"},{"location":"api/reference/#figwizz.colors.parse_color","title":"<code>parse_color(color_input)</code>","text":"<p>Parse color input to RGB tuple.</p> <p>Parameters:</p> Name Type Description Default <code>color_input</code> <p>Hex code ('#RRGGBB'), RGB tuple (R, G, B), or color name ('red', 'blue', etc.)</p> required <p>Returns:</p> Type Description <p>RGB tuple (R, G, B)</p> <p>Examples:</p> <pre><code>parse_color('#FF5733')\n# Returns: (255, 87, 51)\n\nparse_color((255, 87, 51))\n# Returns: (255, 87, 51)\n\nparse_color('red')\n# Returns: (255, 0, 0)\n</code></pre>"},{"location":"api/reference/#webkit","title":"webkit","text":"<p>Web-related utilities for URL handling and response processing.</p>"},{"location":"api/reference/#figwizz.webkit","title":"<code>webkit</code>","text":"<p>Web utilities for URL handling and response processing.</p> <p>This module provides utilities for working with web resources, including PDF detection and response object conversion.</p> Example <pre><code>from figwizz.webkit import is_url_a_pdf\nis_pdf = is_url_a_pdf('http://example.com/document.pdf')\n</code></pre>"},{"location":"api/reference/#figwizz.webkit.convert_response_to_dict","title":"<code>convert_response_to_dict(response, keep_keys=None)</code>","text":"<p>Convert a webkit response to a dictionary.</p> <p>Parameters:</p> Name Type Description Default <code>response</code> <p>The response from a web request.</p> required <code>keep_keys</code> <code>list[str]</code> <p>The keys to keep in the dictionary.</p> <code>None</code> <p>Returns:</p> Type Description <p>A dictionary of the response.</p>"},{"location":"api/reference/#figwizz.webkit.is_url_a_pdf","title":"<code>is_url_a_pdf(url)</code>","text":"<p>Check if a URL points to a PDF file.</p> <p>Parameters:</p> Name Type Description Default <code>url</code> <p>URL to check</p> required <p>Returns:</p> Type Description <p>True if the URL likely points to a PDF</p>"},{"location":"api/reference/#utilities","title":"Utilities","text":""},{"location":"api/reference/#utilsimages","title":"utils.images","text":"<p>Unified image input/output handling.</p>"},{"location":"api/reference/#figwizz.utils.images","title":"<code>images</code>","text":"<p>Unified image input/output handling utilities.</p> <p>This module provides a comprehensive system for handling images in various input formats and converting between different representations. It eliminates the need to manually handle different image types throughout the codebase.</p> <p>Supported input formats: - File paths (local files) - URLs (http/https) - PIL Image objects - Bytes (raw image data) - NumPy arrays - File-like objects (BytesIO, etc.) - Base64 encoded strings</p> <p>The normalize_image_input function is used extensively throughout figwizz to provide a consistent interface for image operations.</p> Example <pre><code>from figwizz.utils.images import normalize_image_input, save_image\n\n# All these work the same way\nimg1 = normalize_image_input('path/to/image.png')\nimg2 = normalize_image_input('https://example.com/image.jpg')\nimg3 = normalize_image_input(bytes_data)\nimg4 = normalize_image_input(numpy_array)\n\n# Save with automatic format handling\nsave_image(img1, 'output.jpg', quality=95)\n</code></pre>"},{"location":"api/reference/#figwizz.utils.images.is_image_path","title":"<code>is_image_path(input_str)</code>","text":"<p>Check if a string is a valid image file path.</p>"},{"location":"api/reference/#figwizz.utils.images.is_url","title":"<code>is_url(input_str)</code>","text":"<p>Check if a string is a URL.</p>"},{"location":"api/reference/#figwizz.utils.images.normalize_image_input","title":"<code>normalize_image_input(image_input, return_type='pil')</code>","text":"<p>Normalize various image input types to a consistent format.</p> <p>Supports: - Path strings (local file paths) - PIL Image objects - bytes (raw image data) - numpy arrays - file-like objects (BytesIO, BufferedReader, etc.) - base64 encoded strings - URLs (http/https)</p> <p>Parameters:</p> Name Type Description Default <code>image_input</code> <p>Image in any supported format</p> required <code>return_type</code> <p>Desired output format ('pil', 'bytes', 'numpy', 'array')</p> <code>'pil'</code> <p>Returns:</p> Type Description <p>Image in requested format (default: PIL Image)</p> <p>Raises:</p> Type Description <code>ValueError</code> <p>If image_input type is not recognized</p> <code>FileNotFoundError</code> <p>If path doesn't exist</p> <code>RuntimeError</code> <p>If URL fetch fails</p> <p>Examples:</p> <pre><code>img = normalize_image_input('/path/to/image.png')\nimg = normalize_image_input(bytes_data)\narr = normalize_image_input(img, return_type='numpy')\n</code></pre>"},{"location":"api/reference/#figwizz.utils.images.normalize_image_output","title":"<code>normalize_image_output(image, output_format='pil')</code>","text":"<p>Convert image to specified output format.</p> <p>Parameters:</p> Name Type Description Default <code>image</code> <p>PIL Image object</p> required <code>output_format</code> <p>Desired format ('pil', 'bytes', 'numpy', 'array')</p> <code>'pil'</code> <p>Returns:</p> Type Description <p>Image in requested format</p>"},{"location":"api/reference/#figwizz.utils.images.save_image","title":"<code>save_image(image, output_path, format=None, make_opaque=None, **kwargs)</code>","text":"<p>Save image to file with automatic format detection and handling.</p> <p>Parameters:</p> Name Type Description Default <code>image</code> <p>Image in any supported format (will be normalized to PIL)</p> required <code>output_path</code> <p>Path where image should be saved</p> required <code>format</code> <p>Image format (e.g., 'PNG', 'JPEG'). Auto-detected from path if None.</p> <code>None</code> <code>make_opaque</code> <p>Whether to add white background for formats that don't support transparency.          Auto-detected if None (True for JPEG/PDF, False otherwise).</p> <code>None</code> <code>**kwargs</code> <p>Additional arguments passed to PIL Image.save()</p> <code>{}</code> <p>Returns:</p> Type Description <p>Path to saved image</p> <p>Examples:</p> <pre><code>save_image(img, 'output.png')\nsave_image(img, 'output.jpg', quality=95)\n</code></pre>"},{"location":"api/reference/#utilsenviron","title":"utils.environ","text":"<p>Environment variable loading and management.</p>"},{"location":"api/reference/#figwizz.utils.environ","title":"<code>environ</code>","text":"<p>Environment variable loading and capability checking functions.</p> <p>This module provides utilities for managing environment variables and detecting available API capabilities based on configured keys. It handles .env file loading and provides helpful capability reports for optional features.</p> <p>Key features: - Automatic .env file discovery in current and parent directories - Support for multiple .env file naming conventions - Capability detection for stock image providers and AI services - Verbose reporting of available features</p> <p>The auto_load_env function is called automatically when importing figwizz, making environment setup seamless.</p> Example <pre><code>from figwizz.utils.environ import check_capabilities, load_env_variables\n\n# Check what features are available\ncapabilities = check_capabilities(verbose=True)\n\n# Manually load specific .env file\nload_env_variables('.env.production')\n</code></pre>"},{"location":"api/reference/#figwizz.utils.environ.auto_load_env","title":"<code>auto_load_env(verbose=False, silent_on_missing=True)</code>","text":"<p>Automatically search for and load environment variables on import.</p>"},{"location":"api/reference/#figwizz.utils.environ.auto_load_env--parameters","title":"Parameters","text":"<p>verbose : bool     If True, print capability information silent_on_missing : bool     If True, don't raise an error if no .env file is found</p>"},{"location":"api/reference/#figwizz.utils.environ.auto_load_env--returns","title":"Returns","text":"<p>dict or None     Dictionary of available capabilities, or None if silent_on_missing=True</p>"},{"location":"api/reference/#figwizz.utils.environ.check_capabilities","title":"<code>check_capabilities(verbose=False)</code>","text":"<p>Check which capabilities are available based on environment variables.</p>"},{"location":"api/reference/#figwizz.utils.environ.check_capabilities--parameters","title":"Parameters","text":"<p>verbose : bool     If True, print detailed capability information</p>"},{"location":"api/reference/#figwizz.utils.environ.check_capabilities--returns","title":"Returns","text":"<p>dict     Dictionary mapping capability categories to available providers</p>"},{"location":"api/reference/#figwizz.utils.environ.load_env_variables","title":"<code>load_env_variables(env_file='auto', update_environ=True, **kwargs)</code>","text":"<p>Load environment variables from a .env file.</p> <p>This function reads key-value pairs from a .env file and optionally updates the system environment variables. It handles common .env file formats including quoted values, inline comments, and empty lines.</p> <p>Parameters:</p> Name Type Description Default <code>env_file</code> <code>str</code> <p>Path to .env file, or 'auto' to search for it. When 'auto', uses search_for_env_file() to locate the file. Defaults to 'auto'.</p> <code>'auto'</code> <code>update_environ</code> <code>bool</code> <p>If True, updates os.environ with the loaded variables. If False, returns the variables as a dictionary without updating the environment. Defaults to True.</p> <code>True</code> <code>**kwargs</code> <p>Additional keyword arguments passed to search_for_env_file() (e.g., max_parents, abspath)</p> <code>{}</code> <p>Returns:</p> Type Description <p>dict or None: Dictionary of environment variables if update_environ=False, otherwise None</p> <p>Raises:</p> Type Description <code>FileNotFoundError</code> <p>If no .env file is found</p> <p>Examples:</p> <pre><code>from figwizz.utils.environ import load_env_variables\n\n# Load and update environment\nload_env_variables()\n\n# Load without updating environment\nenv_vars = load_env_variables(update_environ=False)\nprint(env_vars)\n\n# Load specific file\nload_env_variables(env_file='.env.production')\n</code></pre> Note <ul> <li>Handles quoted values (single or double quotes)</li> <li>Strips inline comments (text after '#')</li> <li>Skips empty lines and comment-only lines</li> <li>Malformed lines are skipped with a warning</li> <li>Supports values containing '=' characters</li> </ul>"},{"location":"api/reference/#figwizz.utils.environ.search_for_env_file","title":"<code>search_for_env_file(env_file='auto', max_parents=3, abspath=False)</code>","text":"<p>Search for environment variable files in the current and parent directories.</p> <p>This function searches for .env files starting from the current working directory and traversing up to a specified number of parent directories. It supports multiple .env file naming conventions.</p> <p>Parameters:</p> Name Type Description Default <code>env_file</code> <code>str</code> <p>Specific .env file name to search for, or 'auto' to search for common variants. Defaults to 'auto'. When 'auto', searches for: .env, .env.local, .env.development, .env.production</p> <code>'auto'</code> <code>max_parents</code> <code>int</code> <p>Maximum number of parent directories to search. Defaults to 3.</p> <code>3</code> <code>abspath</code> <code>bool</code> <p>If True, returns absolute path. If False, returns relative path. Defaults to False.</p> <code>False</code> <p>Returns:</p> Type Description <p>str or None: Path to the found .env file, or None if not found</p> <p>Examples:</p> <pre><code>from figwizz.utils.environ import search_for_env_file\n\n# Search for any common .env file\nenv_path = search_for_env_file()\n\n# Search for a specific .env file\nenv_path = search_for_env_file(env_file='production')\n\n# Get absolute path\nenv_path = search_for_env_file(abspath=True)\n</code></pre> Note <ul> <li>Searches in order: current directory, parent, grandparent, etc.</li> <li>Stops at first match found</li> <li>Prints the path of the found file</li> </ul>"},{"location":"api/reference/#workflows","title":"Workflows","text":""},{"location":"api/reference/#workflowsicons","title":"workflows.icons","text":"<p>Hexicon and icon generation workflows.</p>"},{"location":"api/reference/#figwizz.workflows.icons","title":"<code>icons</code>","text":"<p>Icon workflow and convenience functions.</p> <p>This module provides high-level workflows for creating icons from images, particularly tidyverse-style hexagonal icons (hexicons) commonly used in the R community for package logos.</p> <p>The make_hexicon function is a convenient wrapper around the ngon_crop function with sensible defaults for creating hexagonal icons.</p> Example <pre><code>from figwizz import make_hexicon\n\n# Create a simple hexicon\nhexicon = make_hexicon('logo.png')\nhexicon.save('hexicon.png')\n\n# Create hexicon with border\nhexicon = make_hexicon('logo.png', border_size=5, border_color='auto')\n</code></pre>"},{"location":"api/reference/#figwizz.workflows.icons.make_hexicon","title":"<code>make_hexicon(input_image, size=None, **kwargs)</code>","text":"<p>Make a tidyverse-style Hexicon from an input image.</p> <p>Parameters:</p> Name Type Description Default <code>input_image</code> <p>Image in any supported format (path, PIL Image, bytes, numpy array, URL, etc.).</p> required <code>size</code> <p>Size of the output image as (width, height). If None, uses a square    based on the smallest dimension of the input image.</p> <code>None</code> <code>**kwargs</code> <p>Additional keyword arguments for ngon_crop. shift_x: Horizontal shift in pixels (default: 0). Positive values shift right. shift_y: Vertical shift in pixels (default: 0). Positive values shift down. rotation: Rotation angle in degrees (default: 0). border_size: Width of the border in pixels (default: 0, no border). border_color: Border color. Can be:     - \"auto\": Automatically select contrasting color from image     - Hex code: e.g., \"#FF5733\"     - RGB tuple: e.g., (255, 87, 51)     - Color name: e.g., \"red\", \"blue\" background_color: Background color inside the hexagon (default: None for transparent).     Can be hex code, RGB tuple, or color name. Area outside hexagon remains transparent.</p> <code>{}</code> <p>Returns:     PIL Image object with the hexicon applied.</p> <p>Examples:</p> <pre><code># Make a hexicon with no border\nimg = make_hexicon(\"input.png\")\n\n# Make a hexicon with red border and padding\nimg = make_hexicon(\"input.png\", border_size=3, border_color=\"red\", padding=20)\n\n# Make hexicon with slight upwards shift\nimg = make_hexicon(\"input.png\", shift_y=10)\n\n# Make hexicon with white background inside\nimg = make_hexicon(\"input.png\", background_color=\"white\")\n</code></pre>"},{"location":"workflows/genai/","title":"AI Image Generation","text":"<p>Generate images from text prompts using AI models.</p>"},{"location":"workflows/genai/#installation","title":"Installation","text":"<p>Install with AI support:</p> <pre><code>pip install figwizz[genai]\n</code></pre> <p>This installs the <code>litellm</code> library for AI model access.</p>"},{"location":"workflows/genai/#basic-generation","title":"Basic Generation","text":"<p>Generate images from prompts:</p> <pre><code>from figwizz.generate import generate_images\nimport os\n\n# Set API key\nos.environ['OPENAI_API_KEY'] = 'your_openai_key'\n\n# Generate single image\nimages = generate_images(\n    prompts=['a serene mountain landscape at sunset'],\n    output_dir='generated',\n    n_images=1\n)\n</code></pre>"},{"location":"workflows/genai/#batch-generation","title":"Batch Generation","text":"<p>Generate multiple images from multiple prompts:</p> <pre><code>prompts = [\n    'a futuristic city skyline',\n    'abstract geometric patterns in blue',\n    'minimalist line art of a tree',\n    'vibrant coral reef underwater scene'\n]\n\nimages = generate_images(\n    prompts=prompts,\n    output_dir='ai_images',\n    n_images=3,  # 3 variations per prompt\n    model='dall-e-3'\n)\n</code></pre>"},{"location":"workflows/genai/#using-environment-files","title":"Using Environment Files","text":"<p>Store your API key securely:</p> <pre><code># .env\nOPENAI_API_KEY=your_key_here\n</code></pre> <p>Load and generate:</p> <pre><code>from figwizz.utils import load_env_variables\nfrom figwizz.generate import generate_images\n\n# Load environment\nload_env_variables()\n\n# Generate images\nimages = generate_images(\n    prompts=['cosmic nebula in deep space'],\n    output_dir='space_images'\n)\n</code></pre>"},{"location":"workflows/genai/#supported-models","title":"Supported Models","text":"<p>FigWizz uses litellm which supports multiple AI models:</p> <pre><code># DALL-E 3 (OpenAI)\nimages = generate_images(\n    prompts=['artwork'],\n    output_dir='output',\n    model='dall-e-3',\n    api_key='openai_key'\n)\n\n# DALL-E 2 (OpenAI)\nimages = generate_images(\n    prompts=['artwork'],\n    output_dir='output',\n    model='dall-e-2',\n    api_key='openai_key'\n)\n\n# Stable Diffusion (via API providers)\nimages = generate_images(\n    prompts=['artwork'],\n    output_dir='output',\n    model='stabilityai/stable-diffusion',\n    api_key='stability_key'\n)\n</code></pre>"},{"location":"workflows/genai/#return-pil-images","title":"Return PIL Images","text":"<p>Get PIL Images directly for further processing:</p> <pre><code>images = generate_images(\n    prompts=['abstract art'],\n    output_dir='temp',\n    return_images=True\n)\n\n# images is now a list of PIL Image objects\nfor i, img in enumerate(images):\n    # Process image\n    img = img.resize((512, 512))\n    img.save(f'processed_{i}.png')\n</code></pre>"},{"location":"workflows/genai/#error-handling","title":"Error Handling","text":"<p>Handle generation errors gracefully:</p> <pre><code>from figwizz.generate import generate_images\n\nprompts = [\n    'valid prompt 1',\n    'valid prompt 2',\n    'potentially problematic prompt'\n]\n\ntry:\n    images = generate_images(\n        prompts=prompts,\n        output_dir='output',\n        n_images=2\n    )\n    print(f\"Successfully generated {len(images)} images\")\nexcept Exception as e:\n    print(f\"Generation failed: {e}\")\n</code></pre>"},{"location":"workflows/genai/#post-processing","title":"Post-Processing","text":"<p>Process generated images:</p> <pre><code>from figwizz.generate import generate_images\nfrom figwizz import make_hexicon, convert_image\n\n# Generate\nimages = generate_images(\n    prompts=['logo concept'],\n    output_dir='generated',\n    return_images=True\n)\n\n# Post-process\nfor i, img in enumerate(images):\n    # Create hexicon version\n    hexicon = make_hexicon(img, border_size=10, border_color='auto')\n    hexicon.save(f'hexicon_{i}.png')\n\n    # Convert to JPEG\n    convert_image(img, 'jpg')\n</code></pre>"},{"location":"workflows/genai/#progress-tracking","title":"Progress Tracking","text":"<p>Generation includes progress bars via tqdm:</p> <pre><code>from figwizz.generate import generate_images\n\n# Progress bars show automatically\nimages = generate_images(\n    prompts=['prompt1', 'prompt2', 'prompt3'],\n    output_dir='output',\n    n_images=5  # Shows progress for both prompts and images\n)\n</code></pre>"},{"location":"workflows/genai/#workflow-example","title":"Workflow Example","text":"<p>Complete workflow from generation to hexicon:</p> <pre><code>from figwizz.utils import load_env_variables\nfrom figwizz.generate import generate_images\nfrom figwizz import make_hexicon\nfrom pathlib import Path\n\n# Setup\nload_env_variables()\noutput_dir = Path('project_icons')\noutput_dir.mkdir(exist_ok=True)\n\n# Define prompts\nprompts = [\n    'minimalist python snake logo',\n    'abstract data visualization icon',\n    'geometric mountain peak symbol'\n]\n\n# Generate\nprint(\"Generating images...\")\nimages = generate_images(\n    prompts=prompts,\n    output_dir=str(output_dir / 'raw'),\n    n_images=3,\n    return_images=True\n)\n\n# Create hexicons\nprint(\"Creating hexicons...\")\nhexicon_dir = output_dir / 'hexicons'\nhexicon_dir.mkdir(exist_ok=True)\n\nfor i, img in enumerate(images):\n    hexicon = make_hexicon(\n        img,\n        size=(500, 500),\n        border_size=15,\n        border_color='auto',\n        padding=40\n    )\n    hexicon.save(hexicon_dir / f'hexicon_{i:02d}.png')\n\nprint(f\"Created {len(images)} hexicons!\")\n</code></pre>"},{"location":"workflows/genai/#api-costs","title":"API Costs","text":"<p>Be mindful of API costs:</p> <ul> <li>DALL-E 3: ~$0.04 per image</li> <li>DALL-E 2: ~$0.02 per image</li> <li>Costs vary by model and provider</li> </ul> <p>Use <code>n_images</code> carefully to control costs.</p>"},{"location":"workflows/genai/#troubleshooting","title":"Troubleshooting","text":""},{"location":"workflows/genai/#api-key-not-found","title":"API Key Not Found","text":"<pre><code>ValueError: OPENAI_API_KEY required for image generation\n</code></pre> <p>Solution: Set the environment variable: <pre><code>export OPENAI_API_KEY=\"your_key\"\n</code></pre></p>"},{"location":"workflows/genai/#litellm-not-installed","title":"litellm Not Installed","text":"<pre><code>ImportError: litellm is required for image generation\n</code></pre> <p>Solution: Install genai extras: <pre><code>pip install figwizz[genai]\n</code></pre></p>"},{"location":"workflows/genai/#rate-limiting","title":"Rate Limiting","text":"<p>If you hit rate limits, add delays:</p> <pre><code>import time\nfrom figwizz.generate import generate_images\n\nfor prompt in prompts:\n    images = generate_images([prompt], 'output', n_images=1)\n    time.sleep(2)  # Wait 2 seconds between requests\n</code></pre>"},{"location":"workflows/genai/#see-also","title":"See Also","text":"<ul> <li>Installation - Setting up API keys</li> <li>Icon Workflows - Creating hexicons from generated images</li> <li>API Reference - Complete API documentation</li> </ul>"},{"location":"workflows/icons/","title":"Icons and Hexicons","text":"<p>Create tidyverse-style hexagonal icons and other polygon-shaped graphics.</p>"},{"location":"workflows/icons/#basic-hexicon","title":"Basic Hexicon","text":"<p>Create a simple hexagonal icon:</p> <pre><code>from figwizz import make_hexicon\n\n# Create hexicon from image\nhexicon = make_hexicon('logo.png')\nhexicon.save('hexicon.png')\n</code></pre>"},{"location":"workflows/icons/#with-borders","title":"With Borders","text":"<p>Add professional borders:</p> <pre><code># Auto-detected contrasting border\nhexicon = make_hexicon(\n    'logo.png',\n    border_size=10,\n    border_color='auto'  # Automatically chooses contrasting color\n)\n\n# Custom border color\nhexicon = make_hexicon(\n    'logo.png',\n    border_size=12,\n    border_color='#2C3E50'  # Dark blue-gray\n)\n\n# Named color\nhexicon = make_hexicon(\n    'logo.png',\n    border_size=8,\n    border_color='navy'\n)\n</code></pre>"},{"location":"workflows/icons/#positioning","title":"Positioning","text":"<p>Adjust the content position within the hexicon:</p> <pre><code># Center shift\nhexicon = make_hexicon(\n    'logo.png',\n    shift_x=0,\n    shift_y=-10  # Shift up 10 pixels\n)\n\n# Off-center\nhexicon = make_hexicon(\n    'logo.png',\n    shift_x=15,\n    shift_y=-5\n)\n</code></pre>"},{"location":"workflows/icons/#rotation","title":"Rotation","text":"<p>Rotate the hexagon:</p> <pre><code># Flat top (default rotation=0)\nhexicon = make_hexicon('logo.png', rotation=0)\n\n# Pointy top\nhexicon = make_hexicon('logo.png', rotation=30)\n\n# Custom angle\nhexicon = make_hexicon('logo.png', rotation=45)\n</code></pre>"},{"location":"workflows/icons/#padding","title":"Padding","text":"<p>Add padding to prevent cropping into content:</p> <pre><code>hexicon = make_hexicon(\n    'logo.png',\n    padding=30,  # Add 30px padding\n    border_size=10,\n    border_color='auto'\n)\n</code></pre>"},{"location":"workflows/icons/#custom-size","title":"Custom Size","text":"<p>Specify output dimensions:</p> <pre><code># Standard size\nhexicon = make_hexicon('logo.png', size=(400, 400))\n\n# Large hexicon\nhexicon = make_hexicon('logo.png', size=(800, 800))\n</code></pre>"},{"location":"workflows/icons/#background-color","title":"Background Color","text":"<p>Add a background color inside the hexagon while keeping the outside transparent:</p> <pre><code># White background inside hexagon\nhexicon = make_hexicon('logo.png', background_color='white')\n\n# Custom background color (hex)\nhexicon = make_hexicon('logo.png', background_color='#F0F0F0')\n\n# Custom background color (RGB)\nhexicon = make_hexicon('logo.png', background_color=(240, 240, 240))\n\n# Combine with border\nhexicon = make_hexicon(\n    'logo.png',\n    background_color='white',\n    border_size=10,\n    border_color='black'\n)\n</code></pre>"},{"location":"workflows/icons/#complete-professional-hexicon","title":"Complete Professional Hexicon","text":"<p>All options combined:</p> <pre><code>from figwizz import make_hexicon\n\nhexicon = make_hexicon(\n    input_image='package_logo.png',\n    size=(500, 500),\n    shift_x=0,\n    shift_y=-15,  # Slightly up\n    rotation=0,   # Flat top\n    background_color='white',  # White background inside hexagon\n    border_size=15,\n    border_color='auto',\n    padding=40\n)\n\nhexicon.save('professional_hexicon.png')\n</code></pre>"},{"location":"workflows/icons/#other-polygon-shapes","title":"Other Polygon Shapes","text":"<p>Create other polygon-shaped icons:</p> <pre><code>from figwizz.modify import ngon_crop\n\n# Triangle icon\ntriangle = ngon_crop(\n    'logo.png',\n    sides=3,\n    border_size=8,\n    border_color='#E74C3C'\n)\n\n# Pentagon badge\npentagon = ngon_crop(\n    'logo.png',\n    sides=5,\n    border_size=10,\n    border_color='#3498DB'\n)\n\n# Octagon stop sign style\noctagon = ngon_crop(\n    'logo.png',\n    sides=8,\n    border_size=12,\n    border_color='#C0392B'\n)\n</code></pre>"},{"location":"workflows/icons/#batch-creation","title":"Batch Creation","text":"<p>Create hexicons for multiple logos:</p> <pre><code>from pathlib import Path\nfrom figwizz import make_hexicon\n\ninput_dir = Path('logos')\noutput_dir = Path('hexicons')\noutput_dir.mkdir(exist_ok=True)\n\nfor logo in input_dir.glob('*.png'):\n    hexicon = make_hexicon(\n        str(logo),\n        size=(500, 500),\n        border_size=12,\n        border_color='auto',\n        padding=30\n    )\n    hexicon.save(output_dir / logo.name)\n    print(f\"Created hexicon: {logo.name}\")\n</code></pre>"},{"location":"workflows/icons/#flexible-input","title":"Flexible Input","text":"<p>Hexicons accept various input types:</p> <pre><code>from figwizz import make_hexicon\nfrom PIL import Image\nimport numpy as np\n\n# From file path\nhexicon = make_hexicon('logo.png')\n\n# From PIL Image\nimg = Image.open('logo.png')\nhexicon = make_hexicon(img)\n\n# From numpy array\narr = np.random.randint(0, 256, (200, 200, 3), dtype=np.uint8)\nhexicon = make_hexicon(arr)\n\n# From URL\nhexicon = make_hexicon('https://example.com/logo.png')\n\n# From bytes\nwith open('logo.png', 'rb') as f:\n    logo_bytes = f.read()\nhexicon = make_hexicon(logo_bytes)\n</code></pre>"},{"location":"workflows/icons/#color-schemes","title":"Color Schemes","text":"<p>Create hexicons with themed borders:</p> <pre><code>from figwizz import make_hexicon\n\n# Tidyverse blue\nhexicon = make_hexicon('logo.png', border_color='#1A162D', border_size=12)\n\n# R red\nhexicon = make_hexicon('logo.png', border_color='#276DC2', border_size=12)\n\n# Python yellow\nhexicon = make_hexicon('logo.png', border_color='#FFD43B', border_size=12)\n\n# GitHub dark\nhexicon = make_hexicon('logo.png', border_color='#24292E', border_size=12)\n</code></pre>"},{"location":"workflows/icons/#tips-for-best-results","title":"Tips for Best Results","text":"<ol> <li>High Resolution: Use high-resolution source images (at least 1000x1000px)</li> <li>Square Images: Square images work best for hexicons</li> <li>Padding: Add padding if your logo extends to the edges</li> <li>Contrast: Use <code>border_color='auto'</code> for optimal visibility</li> <li>Positioning: Adjust <code>shift_y</code> to center vertically if needed</li> </ol>"},{"location":"workflows/icons/#example-package-hexicon","title":"Example: Package Hexicon","text":"<p>Create a hexicon for a Python package:</p> <pre><code>from figwizz import make_hexicon\n\n# Assuming you have a square logo\nhexicon = make_hexicon(\n    'mypackage_logo.png',\n    size=(500, 577),  # Standard hexicon dimensions\n    border_size=15,\n    border_color='#1A162D',  # Tidyverse blue\n    padding=40,\n    shift_y=-10  # Slight upward adjustment\n)\n\nhexicon.save('mypackage_hexicon.png')\n\n# Also create a larger version\nhexicon_large = make_hexicon(\n    'mypackage_logo.png',\n    size=(1000, 1154),\n    border_size=30,\n    border_color='#1A162D',\n    padding=80,\n    shift_y=-20\n)\n\nhexicon_large.save('mypackage_hexicon_large.png')\n</code></pre>"},{"location":"workflows/icons/#see-also","title":"See Also","text":"<ul> <li>Image Modification - N-gon cropping details</li> <li>API Reference - Complete API documentation</li> </ul>"},{"location":"workflows/image_conversion/","title":"Image Conversion","text":"<p>Convert images between different formats with automatic handling of transparency and color modes.</p>"},{"location":"workflows/image_conversion/#basic-conversion","title":"Basic Conversion","text":"<p>Convert any image to a different format:</p> <pre><code>from figwizz import convert_image\n\n# Convert PNG to JPEG\nconvert_image('input.png', 'jpg')\n\n# Convert to PDF\nconvert_image('input.png', 'pdf')\n\n# Convert SVG to PNG\nconvert_image('logo.svg', 'png')\n</code></pre>"},{"location":"workflows/image_conversion/#automatic-transparency-handling","title":"Automatic Transparency Handling","text":"<p>FigWizz automatically makes images opaque when converting to formats that don't support transparency:</p> <pre><code># RGBA PNG \u2192 JPEG (automatically adds white background)\nconvert_image('transparent.png', 'jpg')\n\n# RGBA PNG \u2192 PDF (automatically adds white background)\nconvert_image('transparent.png', 'pdf')\n</code></pre>"},{"location":"workflows/image_conversion/#delete-original","title":"Delete Original","text":"<p>Optionally remove the original file after conversion:</p> <pre><code>convert_image('input.png', 'jpg', delete_original=True)\n</code></pre>"},{"location":"workflows/image_conversion/#working-with-bytes","title":"Working with Bytes","text":"<p>Convert image data without saving to disk:</p> <pre><code>from figwizz.convert import bytes_to_image\n\n# Load bytes\nwith open('image.png', 'rb') as f:\n    img_bytes = f.read()\n\n# Convert to PIL Image\nimg = bytes_to_image(img_bytes)\n\n# Or from base64\nimport base64\nb64_string = base64.b64encode(img_bytes).decode()\nimg = bytes_to_image(b64_string)\n</code></pre>"},{"location":"workflows/image_conversion/#svg-conversion","title":"SVG Conversion","text":"<p>Convert SVG files to raster formats (requires cairosvg):</p> <pre><code>from figwizz.convert import svg_to_image\n\n# Read SVG content\nwith open('logo.svg', 'rb') as f:\n    svg_content = f.read()\n\n# Convert to PNG with custom size\nsvg_to_image(svg_content, 'output.png', width=512, height=512)\n\n# Convert with scale factor\nsvg_to_image(svg_content, 'output.png', scale=3.0)\n</code></pre>"},{"location":"workflows/image_conversion/#batch-conversion","title":"Batch Conversion","text":"<p>Convert multiple images:</p> <pre><code>from pathlib import Path\nfrom figwizz import convert_image\n\ninput_dir = Path('inputs')\noutput_format = 'jpg'\n\nfor img_path in input_dir.glob('*.png'):\n    convert_image(str(img_path), output_format)\n</code></pre>"},{"location":"workflows/image_conversion/#flexible-input-types","title":"Flexible Input Types","text":"<p>Convert images from various sources:</p> <pre><code>from figwizz import convert_image\nfrom PIL import Image\nimport numpy as np\n\n# From path\nconvert_image('image.png', 'jpg')\n\n# From PIL Image\nimg = Image.open('image.png')\nconvert_image(img, 'jpg')\n\n# From numpy array\narr = np.random.randint(0, 256, (100, 100, 3), dtype=np.uint8)\nconvert_image(arr, 'jpg')\n\n# From URL\nconvert_image('https://example.com/image.png', 'jpg')\n</code></pre>"},{"location":"workflows/image_conversion/#saving-with-options","title":"Saving with Options","text":"<p>Use the unified save function for more control:</p> <pre><code>from figwizz.utils.images import save_image\nfrom PIL import Image\n\nimg = Image.open('input.png')\n\n# Save with custom quality\nsave_image(img, 'output.jpg', quality=95)\n\n# Save with custom format\nsave_image(img, 'output.webp', format='WEBP')\n\n# Control transparency handling\nsave_image(img, 'output.jpg', make_opaque=True)\n</code></pre>"},{"location":"workflows/image_conversion/#format-support","title":"Format Support","text":"<p>Supported formats: - Raster: PNG, JPEG, TIFF, BMP, WebP - Vector: SVG (input only, requires cairosvg) - Document: PDF</p>"},{"location":"workflows/image_conversion/#see-also","title":"See Also","text":"<ul> <li>Image Modification - Transform and edit images</li> <li>API Reference - Complete API documentation</li> </ul>"},{"location":"workflows/image_modification/","title":"Image Modification","text":"<p>Transform and modify images with FigWizz's modification tools.</p>"},{"location":"workflows/image_modification/#making-images-opaque","title":"Making Images Opaque","text":"<p>Add a solid background to transparent images:</p> <pre><code>from figwizz import make_image_opaque\n\n# Add white background (default)\nimg = make_image_opaque('transparent.png')\nimg.save('opaque.png')\n\n# Custom background color\nimg = make_image_opaque('transparent.png', bg_color=(255, 0, 0))  # Red\nimg.save('red_background.png')\n</code></pre> <p>This is useful when: - Converting RGBA images to JPEG - Preparing images for formats that don't support transparency - Creating consistent backgrounds across multiple images</p>"},{"location":"workflows/image_modification/#n-gon-cropping","title":"N-gon Cropping","text":"<p>Crop images to polygon shapes (triangles, hexagons, octagons, etc.):</p> <pre><code>from figwizz.modify import ngon_crop\n\n# Hexagon (default)\nhexagon = ngon_crop('image.png')\n\n# Triangle\ntriangle = ngon_crop('image.png', sides=3)\n\n# Pentagon\npentagon = ngon_crop('image.png', sides=5)\n\n# Octagon\noctagon = ngon_crop('image.png', sides=8)\n</code></pre>"},{"location":"workflows/image_modification/#with-borders","title":"With Borders","text":"<p>Add borders to your n-gon crops:</p> <pre><code># Auto-detected contrasting border\nimg = ngon_crop('image.png', border_size=10, border_color='auto')\n\n# Custom color border (hex)\nimg = ngon_crop('image.png', border_size=5, border_color='#FF5733')\n\n# Custom color border (RGB)\nimg = ngon_crop('image.png', border_size=5, border_color=(255, 87, 51))\n\n# Named color\nimg = ngon_crop('image.png', border_size=5, border_color='red')\n</code></pre>"},{"location":"workflows/image_modification/#position-and-rotation","title":"Position and Rotation","text":"<p>Adjust the crop position and rotation:</p> <pre><code># Shift position\nimg = ngon_crop('image.png', shift_x=10, shift_y=-5)\n\n# Rotate\nimg = ngon_crop('image.png', rotation=30)  # degrees\n\n# Combine\nimg = ngon_crop('image.png', shift_x=5, shift_y=-10, rotation=15)\n</code></pre>"},{"location":"workflows/image_modification/#padding","title":"Padding","text":"<p>Add padding before cropping to prevent cutting into image content:</p> <pre><code>img = ngon_crop('image.png', padding=20)\n</code></pre>"},{"location":"workflows/image_modification/#custom-size","title":"Custom Size","text":"<p>Specify output dimensions:</p> <pre><code>img = ngon_crop('image.png', crop_size=(300, 300))\n</code></pre>"},{"location":"workflows/image_modification/#background-color","title":"Background Color","text":"<p>Add a background color inside the polygon while keeping the outside transparent:</p> <pre><code># White background inside hexagon\nimg = ngon_crop('image.png', background_color='white')\n\n# Custom background color (hex)\nimg = ngon_crop('image.png', background_color='#F0F0F0')\n\n# Custom background color (RGB)\nimg = ngon_crop('image.png', background_color=(240, 240, 240))\n\n# Combine with border\nimg = ngon_crop('image.png', \n                background_color='white',\n                border_size=10,\n                border_color='black')\n</code></pre>"},{"location":"workflows/image_modification/#complete-example","title":"Complete Example","text":"<p>Create a professional hexicon with all options:</p> <pre><code>from figwizz.modify import ngon_crop\n\nhexicon = ngon_crop(\n    'logo.png',\n    sides=6,\n    crop_size=(400, 400),\n    shift_x=0,\n    shift_y=-10,  # Shift up slightly\n    rotation=0,\n    background_color='white',  # White background inside hexagon\n    border_size=12,\n    border_color='auto',  # Contrasting color\n    padding=30  # Space around content\n)\n\nhexicon.save('professional_hexicon.png')\n</code></pre>"},{"location":"workflows/image_modification/#batch-processing","title":"Batch Processing","text":"<p>Process multiple images:</p> <pre><code>from pathlib import Path\nfrom figwizz.modify import ngon_crop\n\ninput_dir = Path('logos')\noutput_dir = Path('hexicons')\noutput_dir.mkdir(exist_ok=True)\n\nfor img_path in input_dir.glob('*.png'):\n    hexicon = ngon_crop(\n        str(img_path),\n        border_size=10,\n        border_color='auto'\n    )\n    hexicon.save(output_dir / img_path.name)\n</code></pre>"},{"location":"workflows/image_modification/#color-processing","title":"Color Processing","text":"<p>FigWizz provides color utilities for advanced customization:</p> <pre><code>from figwizz.colors import parse_color, extract_dominant_color, get_contrasting_color\n\n# Parse different color formats\nrgb = parse_color('#FF5733')  # (255, 87, 51)\nrgb = parse_color('red')      # (255, 0, 0)\nrgb = parse_color((100, 150, 200))  # (100, 150, 200)\n\n# Extract dominant color from image\nfrom PIL import Image\nimg = Image.open('photo.png')\ndominant = extract_dominant_color(img)\n\n# Get contrasting color\ncontrasting = get_contrasting_color(dominant, prefer_dark=True)\n</code></pre>"},{"location":"workflows/image_modification/#see-also","title":"See Also","text":"<ul> <li>Icon Workflows - Hexicon-specific workflows</li> <li>Image Conversion - Format conversion</li> <li>API Reference - Complete API documentation</li> </ul>"},{"location":"workflows/presentations/","title":"Presentations to Images","text":"<p>Convert PowerPoint and Keynote presentations to high-quality images.</p>"},{"location":"workflows/presentations/#basic-conversion","title":"Basic Conversion","text":"<p>Convert slides to images with automatic cropping:</p> <pre><code>from figwizz import slides_to_images\n\nslides_to_images(\n    input_path='presentation.pptx',\n    output_path='figures/',\n    crop_images=True\n)\n</code></pre> <p>This works with: - PowerPoint files (<code>.ppt</code>, <code>.pptx</code>) - Keynote files (<code>.key</code>) on macOS</p>"},{"location":"workflows/presentations/#custom-filenames","title":"Custom Filenames","text":"<p>Specify a naming pattern:</p> <pre><code>slides_to_images(\n    input_path='talk.key',\n    output_path='slides/',\n    filename_format='slide{:02d}.png'  # slide01.png, slide02.png, ...\n)\n</code></pre>"},{"location":"workflows/presentations/#cropping-options","title":"Cropping Options","text":"<p>Control whitespace cropping and margins:</p> <pre><code>slides_to_images(\n    input_path='presentation.pptx',\n    output_path='figures/',\n    crop_images=True,\n    margin_size='0.5cm',  # Add 0.5cm margin after cropping\n    dpi=300  # High quality output\n)\n</code></pre>"},{"location":"workflows/presentations/#without-cropping","title":"Without Cropping","text":"<p>Skip the automatic cropping:</p> <pre><code>slides_to_images(\n    input_path='deck.pptx',\n    output_path='raw_slides/',\n    crop_images=False\n)\n</code></pre>"},{"location":"workflows/presentations/#manual-cropping","title":"Manual Cropping","text":"<p>Crop whitespace from existing images:</p> <pre><code>from figwizz.stitchkit import crop_whitespace\n\n# Single image\ncrop_whitespace(\n    image_path='slide.png',\n    output_path='cropped_slide.png',\n    margin_size='1cm',\n    dpi=300\n)\n\n# Directory of images\ncrop_whitespace(\n    image_path='slides/',  # Directory\n    margin_size='0.5cm'\n)\n</code></pre>"},{"location":"workflows/presentations/#converting-to-pdf","title":"Converting to PDF","text":"<p>Convert slides to individual PDFs:</p> <pre><code>from figwizz.stitchkit import convert_to_pdf\n\n# Single image to PDF\nconvert_to_pdf('slide1.png', dpi=300)\n\n# Directory of images to PDFs\nconvert_to_pdf('figures/', dpi=300)\n</code></pre>"},{"location":"workflows/presentations/#platform-support","title":"Platform Support","text":""},{"location":"workflows/presentations/#macos","title":"macOS","text":"<p>Uses AppleScript (built-in):</p> <pre><code># PowerPoint\nslides_to_images('presentation.pptx', 'output/')\n\n# Keynote\nslides_to_images('presentation.key', 'output/')\n</code></pre> <p>Requirements: - Microsoft PowerPoint (for <code>.ppt</code>/<code>.pptx</code>) - Keynote (for <code>.key</code>)</p>"},{"location":"workflows/presentations/#windows","title":"Windows","text":"<p>Uses COM interface:</p> <pre><code>pip install pywin32\n</code></pre> <pre><code>slides_to_images('presentation.pptx', 'output/')\n</code></pre> <p>Requirements: - Microsoft PowerPoint installed</p>"},{"location":"workflows/presentations/#linux","title":"Linux","text":"<p>Uses LibreOffice command-line:</p> <pre><code># Ubuntu/Debian\nsudo apt-get install libreoffice\n\n# Fedora\nsudo dnf install libreoffice\n</code></pre> <pre><code>slides_to_images('presentation.pptx', 'output/')\n</code></pre>"},{"location":"workflows/presentations/#complete-workflow","title":"Complete Workflow","text":"<p>Full workflow from presentation to publication-ready figures:</p> <pre><code>from figwizz import slides_to_images\nfrom figwizz.stitchkit import convert_to_pdf\n\n# 1. Convert slides to images\nslides_to_images(\n    input_path='conference_talk.pptx',\n    output_path='figures/',\n    filename_format='figure{:01d}.png',\n    crop_images=True,\n    margin_size='1cm',\n    dpi=300\n)\n\n# 2. Convert to PDF for publication\nconvert_to_pdf('figures/', dpi=300)\n\nprint(\"Figures ready for publication!\")\n</code></pre>"},{"location":"workflows/presentations/#batch-processing","title":"Batch Processing","text":"<p>Process multiple presentations:</p> <pre><code>from pathlib import Path\nfrom figwizz import slides_to_images\n\npresentations = Path('presentations')\n\nfor pptx in presentations.glob('*.pptx'):\n    output_dir = Path('figures') / pptx.stem\n    slides_to_images(\n        str(pptx),\n        str(output_dir),\n        crop_images=True,\n        margin_size='1cm'\n    )\n</code></pre>"},{"location":"workflows/presentations/#advanced-imagemagick-conversion","title":"Advanced: ImageMagick Conversion","text":"<p>For even more control, use ImageMagick:</p> <pre><code>from figwizz.stitchkit import mogrify_images_to_pdf\n\n# Requires ImageMagick installed\nmogrify_images_to_pdf('figures/', pdf_only=True)\n</code></pre>"},{"location":"workflows/presentations/#troubleshooting","title":"Troubleshooting","text":""},{"location":"workflows/presentations/#macos-permission-issues","title":"macOS Permission Issues","text":"<p>If AppleScript fails: 1. Open System Preferences \u2192 Security &amp; Privacy \u2192 Privacy 2. Grant Terminal/IDE access to \"System Events\" 3. Grant access to PowerPoint/Keynote</p>"},{"location":"workflows/presentations/#windows-com-errors","title":"Windows COM Errors","text":"<p>If conversion fails: 1. Ensure PowerPoint is installed 2. Run Python as administrator 3. Check <code>pywin32</code> is installed: <code>pip install pywin32</code></p>"},{"location":"workflows/presentations/#linux-libreoffice-not-found","title":"Linux LibreOffice Not Found","text":"<p>If <code>soffice</code> command not found: <pre><code>which soffice  # Check if installed\nsudo apt-get install libreoffice  # Install if needed\n</code></pre></p>"},{"location":"workflows/presentations/#see-also","title":"See Also","text":"<ul> <li>Installation - Platform setup</li> <li>Image Conversion - Converting output images</li> <li>API Reference - Complete API documentation</li> </ul>"},{"location":"workflows/scraping/","title":"Scraping Images","text":"<p>Extract images from PDFs, websites, and download stock photos.</p>"},{"location":"workflows/scraping/#extracting-from-pdfs","title":"Extracting from PDFs","text":"<p>Extract figures from academic papers and documents:</p> <pre><code>from figwizz import extract_images_from_pdf\n\n# Basic extraction\nimages = extract_images_from_pdf(\n    pdf_path='paper.pdf',\n    output_dir='extracted_figures'\n)\n\nprint(f\"Extracted {len(images)} images\")\n</code></pre>"},{"location":"workflows/scraping/#filter-by-size","title":"Filter by Size","text":"<p>Filter out small icons and decorations:</p> <pre><code>images = extract_images_from_pdf(\n    pdf_path='paper.pdf',\n    output_dir='figures',\n    min_width=300,\n    min_height=300\n)\n</code></pre>"},{"location":"workflows/scraping/#custom-naming","title":"Custom Naming","text":"<p>Use custom filename prefixes:</p> <pre><code>images = extract_images_from_pdf(\n    pdf_path='smith2023.pdf',\n    output_dir='figures',\n    name_prefix='smith2023_fig'\n)\n# Produces: smith2023_fig001.png, smith2023_fig002.png, ...\n</code></pre>"},{"location":"workflows/scraping/#extracting-from-urls","title":"Extracting from URLs","text":"<p>Download images from web pages:</p> <pre><code>from figwizz import extract_images_from_url\n\n# Extract from article\nimages = extract_images_from_url(\n    url='https://example.com/article',\n    output_dir='web_images'\n)\n</code></pre>"},{"location":"workflows/scraping/#svg-conversion","title":"SVG Conversion","text":"<p>Convert SVG images to PNG automatically:</p> <pre><code>images = extract_images_from_url(\n    url='https://example.com/article',\n    output_dir='images',\n    convert_svg=True,\n    svg_scale=3.0  # High quality\n)\n</code></pre>"},{"location":"workflows/scraping/#size-filtering","title":"Size Filtering","text":"<p>Only download images above a certain size:</p> <pre><code>images = extract_images_from_url(\n    url='https://example.com/gallery',\n    output_dir='large_images',\n    min_width=800,\n    min_height=600\n)\n</code></pre>"},{"location":"workflows/scraping/#downloading-from-pdf-urls","title":"Downloading from PDF URLs","text":"<p>FigWizz automatically detects and handles PDF URLs:</p> <pre><code>from figwizz import extract_images_from_url\n\n# Will automatically detect PDF and extract images\nimages = extract_images_from_url(\n    url='https://arxiv.org/pdf/2301.12345.pdf',\n    output_dir='arxiv_figures'\n)\n</code></pre> <p>Or use the PDF-specific function:</p> <pre><code>from figwizz import download_pdf_from_url, extract_images_from_pdf\n\n# Download PDF\npdf_path = download_pdf_from_url('https://example.com/paper.pdf')\n\n# Extract images\nimages = extract_images_from_pdf(pdf_path, 'figures')\n</code></pre>"},{"location":"workflows/scraping/#stock-image-downloads","title":"Stock Image Downloads","text":""},{"location":"workflows/scraping/#unsplash","title":"Unsplash","text":"<p>Download high-quality stock photos from Unsplash:</p> <pre><code>from figwizz import download_stock_images\nimport os\n\n# Set API key\nos.environ['UNSPLASH_ACCESS_KEY'] = 'your_key_here'\n\n# Download images\nimages = download_stock_images(\n    query='nature landscape',\n    n_images=10,\n    output_dir='stock_images',\n    provider='unsplash'\n)\n</code></pre>"},{"location":"workflows/scraping/#pixabay","title":"Pixabay","text":"<p>Download from Pixabay:</p> <pre><code>import os\nfrom figwizz import download_stock_images\n\n# Set API key\nos.environ['PIXABAY_API_KEY'] = 'your_key_here'\n\n# Download images\nimages = download_stock_images(\n    query='business meeting',\n    n_images=20,\n    output_dir='business_images',\n    provider='pixabay'\n)\n</code></pre>"},{"location":"workflows/scraping/#metadata","title":"Metadata","text":"<p>Downloaded images include JSON metadata files:</p> <pre><code>import json\n\n# Load metadata for an image\nwith open('stock_images/image_1.json', 'r') as f:\n    metadata = json.load(f)\n\nprint(metadata['User'])          # Photographer name\nprint(metadata['Image_URL'])     # Original URL\nprint(metadata['Alt_Description'])  # Description\nprint(metadata['Tags'])          # Tags\n</code></pre>"},{"location":"workflows/scraping/#using-environment-files","title":"Using Environment Files","text":"<p>Store API keys in a <code>.env</code> file:</p> <pre><code># .env\nUNSPLASH_ACCESS_KEY=your_unsplash_key\nPIXABAY_API_KEY=your_pixabay_key\n</code></pre> <p>Load automatically:</p> <pre><code>from figwizz.utils import load_env_variables\nfrom figwizz import download_stock_images\n\n# Load environment variables\nload_env_variables()\n\n# API keys are now available\nimages = download_stock_images(\n    'mountains', \n    n_images=5, \n    output_dir='images',\n    provider='unsplash'\n)\n</code></pre>"},{"location":"workflows/scraping/#command-line-usage","title":"Command Line Usage","text":"<p>Use the included script for quick extraction:</p> <pre><code># Extract from PDF\npython scripts/download_figures.py paper.pdf -o figures/\n\n# Extract from URL\npython scripts/download_figures.py https://example.com/article -o images/\n\n# With custom filtering\npython scripts/download_figures.py paper.pdf -o figures/ \\\n    --min-width 400 --min-height 400 \\\n    --name-prefix experiment\n\n# Convert SVG files\npython scripts/download_figures.py https://example.com/page -o images/ \\\n    --convert-svg --svg-scale 5.0\n</code></pre>"},{"location":"workflows/scraping/#batch-processing","title":"Batch Processing","text":"<p>Process multiple sources:</p> <pre><code>from figwizz import extract_images_from_pdf\nfrom pathlib import Path\n\npdf_dir = Path('papers')\noutput_base = Path('extracted')\n\nfor pdf_path in pdf_dir.glob('*.pdf'):\n    output_dir = output_base / pdf_path.stem\n    images = extract_images_from_pdf(\n        str(pdf_path),\n        str(output_dir),\n        min_width=200,\n        min_height=200\n    )\n    print(f\"{pdf_path.name}: {len(images)} images\")\n</code></pre>"},{"location":"workflows/scraping/#see-also","title":"See Also","text":"<ul> <li>Installation - Setting up API keys</li> <li>API Reference - Complete API documentation</li> </ul>"}]}